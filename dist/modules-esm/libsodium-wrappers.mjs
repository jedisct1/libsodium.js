import e from"libsodium";let a;const r={},t=e.ready.then(function(){function t(){if(a._sodium_init()<0)throw new Error("libsodium was not correctly initialized.");for(var e=["crypto_aead_aegis128l_decrypt","crypto_aead_aegis128l_decrypt_detached","crypto_aead_aegis128l_encrypt","crypto_aead_aegis128l_encrypt_detached","crypto_aead_aegis128l_keygen","crypto_aead_aegis256_decrypt","crypto_aead_aegis256_decrypt_detached","crypto_aead_aegis256_encrypt","crypto_aead_aegis256_encrypt_detached","crypto_aead_aegis256_keygen","crypto_aead_chacha20poly1305_decrypt","crypto_aead_chacha20poly1305_decrypt_detached","crypto_aead_chacha20poly1305_encrypt","crypto_aead_chacha20poly1305_encrypt_detached","crypto_aead_chacha20poly1305_ietf_decrypt","crypto_aead_chacha20poly1305_ietf_decrypt_detached","crypto_aead_chacha20poly1305_ietf_encrypt","crypto_aead_chacha20poly1305_ietf_encrypt_detached","crypto_aead_chacha20poly1305_ietf_keygen","crypto_aead_chacha20poly1305_keygen","crypto_aead_xchacha20poly1305_ietf_decrypt","crypto_aead_xchacha20poly1305_ietf_decrypt_detached","crypto_aead_xchacha20poly1305_ietf_encrypt","crypto_aead_xchacha20poly1305_ietf_encrypt_detached","crypto_aead_xchacha20poly1305_ietf_keygen","crypto_auth","crypto_auth_hmacsha256","crypto_auth_hmacsha256_final","crypto_auth_hmacsha256_init","crypto_auth_hmacsha256_keygen","crypto_auth_hmacsha256_update","crypto_auth_hmacsha256_verify","crypto_auth_hmacsha512","crypto_auth_hmacsha512256","crypto_auth_hmacsha512256_final","crypto_auth_hmacsha512256_init","crypto_auth_hmacsha512256_keygen","crypto_auth_hmacsha512256_update","crypto_auth_hmacsha512256_verify","crypto_auth_hmacsha512_final","crypto_auth_hmacsha512_init","crypto_auth_hmacsha512_keygen","crypto_auth_hmacsha512_update","crypto_auth_hmacsha512_verify","crypto_auth_keygen","crypto_auth_verify","crypto_box_beforenm","crypto_box_curve25519xchacha20poly1305_beforenm","crypto_box_curve25519xchacha20poly1305_detached","crypto_box_curve25519xchacha20poly1305_detached_afternm","crypto_box_curve25519xchacha20poly1305_easy","crypto_box_curve25519xchacha20poly1305_easy_afternm","crypto_box_curve25519xchacha20poly1305_keypair","crypto_box_curve25519xchacha20poly1305_open_detached","crypto_box_curve25519xchacha20poly1305_open_detached_afternm","crypto_box_curve25519xchacha20poly1305_open_easy","crypto_box_curve25519xchacha20poly1305_open_easy_afternm","crypto_box_curve25519xchacha20poly1305_seal","crypto_box_curve25519xchacha20poly1305_seal_open","crypto_box_curve25519xchacha20poly1305_seed_keypair","crypto_box_detached","crypto_box_easy","crypto_box_easy_afternm","crypto_box_keypair","crypto_box_open_detached","crypto_box_open_easy","crypto_box_open_easy_afternm","crypto_box_seal","crypto_box_seal_open","crypto_box_seed_keypair","crypto_core_ed25519_add","crypto_core_ed25519_from_hash","crypto_core_ed25519_from_uniform","crypto_core_ed25519_is_valid_point","crypto_core_ed25519_random","crypto_core_ed25519_scalar_add","crypto_core_ed25519_scalar_complement","crypto_core_ed25519_scalar_invert","crypto_core_ed25519_scalar_mul","crypto_core_ed25519_scalar_negate","crypto_core_ed25519_scalar_random","crypto_core_ed25519_scalar_reduce","crypto_core_ed25519_scalar_sub","crypto_core_ed25519_sub","crypto_core_hchacha20","crypto_core_hsalsa20","crypto_core_ristretto255_add","crypto_core_ristretto255_from_hash","crypto_core_ristretto255_is_valid_point","crypto_core_ristretto255_random","crypto_core_ristretto255_scalar_add","crypto_core_ristretto255_scalar_complement","crypto_core_ristretto255_scalar_invert","crypto_core_ristretto255_scalar_mul","crypto_core_ristretto255_scalar_negate","crypto_core_ristretto255_scalar_random","crypto_core_ristretto255_scalar_reduce","crypto_core_ristretto255_scalar_sub","crypto_core_ristretto255_sub","crypto_generichash","crypto_generichash_blake2b_salt_personal","crypto_generichash_final","crypto_generichash_init","crypto_generichash_keygen","crypto_generichash_update","crypto_hash","crypto_hash_sha256","crypto_hash_sha256_final","crypto_hash_sha256_init","crypto_hash_sha256_update","crypto_hash_sha512","crypto_hash_sha512_final","crypto_hash_sha512_init","crypto_hash_sha512_update","crypto_kdf_derive_from_key","crypto_kdf_keygen","crypto_kx_client_session_keys","crypto_kx_keypair","crypto_kx_seed_keypair","crypto_kx_server_session_keys","crypto_onetimeauth","crypto_onetimeauth_final","crypto_onetimeauth_init","crypto_onetimeauth_keygen","crypto_onetimeauth_update","crypto_onetimeauth_verify","crypto_pwhash","crypto_pwhash_scryptsalsa208sha256","crypto_pwhash_scryptsalsa208sha256_ll","crypto_pwhash_scryptsalsa208sha256_str","crypto_pwhash_scryptsalsa208sha256_str_verify","crypto_pwhash_str","crypto_pwhash_str_needs_rehash","crypto_pwhash_str_verify","crypto_scalarmult","crypto_scalarmult_base","crypto_scalarmult_ed25519","crypto_scalarmult_ed25519_base","crypto_scalarmult_ed25519_base_noclamp","crypto_scalarmult_ed25519_noclamp","crypto_scalarmult_ristretto255","crypto_scalarmult_ristretto255_base","crypto_secretbox_detached","crypto_secretbox_easy","crypto_secretbox_keygen","crypto_secretbox_open_detached","crypto_secretbox_open_easy","crypto_secretstream_xchacha20poly1305_init_pull","crypto_secretstream_xchacha20poly1305_init_push","crypto_secretstream_xchacha20poly1305_keygen","crypto_secretstream_xchacha20poly1305_pull","crypto_secretstream_xchacha20poly1305_push","crypto_secretstream_xchacha20poly1305_rekey","crypto_shorthash","crypto_shorthash_keygen","crypto_shorthash_siphashx24","crypto_sign","crypto_sign_detached","crypto_sign_ed25519_pk_to_curve25519","crypto_sign_ed25519_sk_to_curve25519","crypto_sign_ed25519_sk_to_pk","crypto_sign_ed25519_sk_to_seed","crypto_sign_final_create","crypto_sign_final_verify","crypto_sign_init","crypto_sign_keypair","crypto_sign_open","crypto_sign_seed_keypair","crypto_sign_update","crypto_sign_verify_detached","crypto_stream_chacha20","crypto_stream_chacha20_ietf_xor","crypto_stream_chacha20_ietf_xor_ic","crypto_stream_chacha20_keygen","crypto_stream_chacha20_xor","crypto_stream_chacha20_xor_ic","crypto_stream_keygen","crypto_stream_xchacha20_keygen","crypto_stream_xchacha20_xor","crypto_stream_xchacha20_xor_ic","randombytes_buf","randombytes_buf_deterministic","randombytes_close","randombytes_random","randombytes_set_implementation","randombytes_stir","randombytes_uniform","sodium_version_string"],t=[L,O,U,C,P,R,X,G,D,F,V,H,W,q,z,j,J,Q,Z,$,ee,ae,re,te,_e,ne,se,ce,he,oe,pe,ye,ie,le,ue,de,ve,ge,be,fe,me,Ee,xe,ke,Se,Te,we,Ye,Be,Ae,Me,Ie,Ke,Ne,Le,Oe,Ue,Ce,Pe,Re,Xe,Ge,De,Fe,Ve,He,We,qe,ze,je,Je,Qe,Ze,$e,ea,aa,ra,ta,_a,na,sa,ca,ha,oa,pa,ya,ia,la,ua,da,va,ga,ba,fa,ma,Ea,xa,ka,Sa,Ta,wa,Ya,Ba,Aa,Ma,Ia,Ka,Na,La,Oa,Ua,Ca,Pa,Ra,Xa,Ga,Da,Fa,Va,Ha,Wa,qa,za,ja,Ja,Qa,Za,$a,er,ar,rr,tr,_r,nr,sr,cr,hr,or,pr,yr,ir,lr,ur,dr,vr,gr,br,fr,mr,Er,xr,kr,Sr,Tr,wr,Yr,Br,Ar,Mr,Ir,Kr,Nr,Lr,Or,Ur,Cr,Pr,Rr,Xr,Gr,Dr,Fr,Vr,Hr,Wr,qr,zr,jr,Jr,Qr,Zr,$r,et,at,rt,tt,_t,nt],_=0;_<t.length;_++)"function"==typeof a["_"+e[_]]&&(r[e[_]]=t[_]);var n=["SODIUM_LIBRARY_VERSION_MAJOR","SODIUM_LIBRARY_VERSION_MINOR","crypto_aead_aegis128l_ABYTES","crypto_aead_aegis128l_KEYBYTES","crypto_aead_aegis128l_MESSAGEBYTES_MAX","crypto_aead_aegis128l_NPUBBYTES","crypto_aead_aegis128l_NSECBYTES","crypto_aead_aegis256_ABYTES","crypto_aead_aegis256_KEYBYTES","crypto_aead_aegis256_MESSAGEBYTES_MAX","crypto_aead_aegis256_NPUBBYTES","crypto_aead_aegis256_NSECBYTES","crypto_aead_aes256gcm_ABYTES","crypto_aead_aes256gcm_KEYBYTES","crypto_aead_aes256gcm_MESSAGEBYTES_MAX","crypto_aead_aes256gcm_NPUBBYTES","crypto_aead_aes256gcm_NSECBYTES","crypto_aead_chacha20poly1305_ABYTES","crypto_aead_chacha20poly1305_IETF_ABYTES","crypto_aead_chacha20poly1305_IETF_KEYBYTES","crypto_aead_chacha20poly1305_IETF_MESSAGEBYTES_MAX","crypto_aead_chacha20poly1305_IETF_NPUBBYTES","crypto_aead_chacha20poly1305_IETF_NSECBYTES","crypto_aead_chacha20poly1305_KEYBYTES","crypto_aead_chacha20poly1305_MESSAGEBYTES_MAX","crypto_aead_chacha20poly1305_NPUBBYTES","crypto_aead_chacha20poly1305_NSECBYTES","crypto_aead_chacha20poly1305_ietf_ABYTES","crypto_aead_chacha20poly1305_ietf_KEYBYTES","crypto_aead_chacha20poly1305_ietf_MESSAGEBYTES_MAX","crypto_aead_chacha20poly1305_ietf_NPUBBYTES","crypto_aead_chacha20poly1305_ietf_NSECBYTES","crypto_aead_xchacha20poly1305_IETF_ABYTES","crypto_aead_xchacha20poly1305_IETF_KEYBYTES","crypto_aead_xchacha20poly1305_IETF_MESSAGEBYTES_MAX","crypto_aead_xchacha20poly1305_IETF_NPUBBYTES","crypto_aead_xchacha20poly1305_IETF_NSECBYTES","crypto_aead_xchacha20poly1305_ietf_ABYTES","crypto_aead_xchacha20poly1305_ietf_KEYBYTES","crypto_aead_xchacha20poly1305_ietf_MESSAGEBYTES_MAX","crypto_aead_xchacha20poly1305_ietf_NPUBBYTES","crypto_aead_xchacha20poly1305_ietf_NSECBYTES","crypto_auth_BYTES","crypto_auth_KEYBYTES","crypto_auth_hmacsha256_BYTES","crypto_auth_hmacsha256_KEYBYTES","crypto_auth_hmacsha512256_BYTES","crypto_auth_hmacsha512256_KEYBYTES","crypto_auth_hmacsha512_BYTES","crypto_auth_hmacsha512_KEYBYTES","crypto_box_BEFORENMBYTES","crypto_box_MACBYTES","crypto_box_MESSAGEBYTES_MAX","crypto_box_NONCEBYTES","crypto_box_PUBLICKEYBYTES","crypto_box_SEALBYTES","crypto_box_SECRETKEYBYTES","crypto_box_SEEDBYTES","crypto_box_curve25519xchacha20poly1305_BEFORENMBYTES","crypto_box_curve25519xchacha20poly1305_MACBYTES","crypto_box_curve25519xchacha20poly1305_MESSAGEBYTES_MAX","crypto_box_curve25519xchacha20poly1305_NONCEBYTES","crypto_box_curve25519xchacha20poly1305_PUBLICKEYBYTES","crypto_box_curve25519xchacha20poly1305_SEALBYTES","crypto_box_curve25519xchacha20poly1305_SECRETKEYBYTES","crypto_box_curve25519xchacha20poly1305_SEEDBYTES","crypto_box_curve25519xsalsa20poly1305_BEFORENMBYTES","crypto_box_curve25519xsalsa20poly1305_MACBYTES","crypto_box_curve25519xsalsa20poly1305_MESSAGEBYTES_MAX","crypto_box_curve25519xsalsa20poly1305_NONCEBYTES","crypto_box_curve25519xsalsa20poly1305_PUBLICKEYBYTES","crypto_box_curve25519xsalsa20poly1305_SECRETKEYBYTES","crypto_box_curve25519xsalsa20poly1305_SEEDBYTES","crypto_core_ed25519_BYTES","crypto_core_ed25519_HASHBYTES","crypto_core_ed25519_NONREDUCEDSCALARBYTES","crypto_core_ed25519_SCALARBYTES","crypto_core_ed25519_UNIFORMBYTES","crypto_core_hchacha20_CONSTBYTES","crypto_core_hchacha20_INPUTBYTES","crypto_core_hchacha20_KEYBYTES","crypto_core_hchacha20_OUTPUTBYTES","crypto_core_hsalsa20_CONSTBYTES","crypto_core_hsalsa20_INPUTBYTES","crypto_core_hsalsa20_KEYBYTES","crypto_core_hsalsa20_OUTPUTBYTES","crypto_core_ristretto255_BYTES","crypto_core_ristretto255_HASHBYTES","crypto_core_ristretto255_NONREDUCEDSCALARBYTES","crypto_core_ristretto255_SCALARBYTES","crypto_core_salsa2012_CONSTBYTES","crypto_core_salsa2012_INPUTBYTES","crypto_core_salsa2012_KEYBYTES","crypto_core_salsa2012_OUTPUTBYTES","crypto_core_salsa208_CONSTBYTES","crypto_core_salsa208_INPUTBYTES","crypto_core_salsa208_KEYBYTES","crypto_core_salsa208_OUTPUTBYTES","crypto_core_salsa20_CONSTBYTES","crypto_core_salsa20_INPUTBYTES","crypto_core_salsa20_KEYBYTES","crypto_core_salsa20_OUTPUTBYTES","crypto_generichash_BYTES","crypto_generichash_BYTES_MAX","crypto_generichash_BYTES_MIN","crypto_generichash_KEYBYTES","crypto_generichash_KEYBYTES_MAX","crypto_generichash_KEYBYTES_MIN","crypto_generichash_blake2b_BYTES","crypto_generichash_blake2b_BYTES_MAX","crypto_generichash_blake2b_BYTES_MIN","crypto_generichash_blake2b_KEYBYTES","crypto_generichash_blake2b_KEYBYTES_MAX","crypto_generichash_blake2b_KEYBYTES_MIN","crypto_generichash_blake2b_PERSONALBYTES","crypto_generichash_blake2b_SALTBYTES","crypto_hash_BYTES","crypto_hash_sha256_BYTES","crypto_hash_sha512_BYTES","crypto_kdf_BYTES_MAX","crypto_kdf_BYTES_MIN","crypto_kdf_CONTEXTBYTES","crypto_kdf_KEYBYTES","crypto_kdf_blake2b_BYTES_MAX","crypto_kdf_blake2b_BYTES_MIN","crypto_kdf_blake2b_CONTEXTBYTES","crypto_kdf_blake2b_KEYBYTES","crypto_kdf_hkdf_sha256_BYTES_MAX","crypto_kdf_hkdf_sha256_BYTES_MIN","crypto_kdf_hkdf_sha256_KEYBYTES","crypto_kdf_hkdf_sha512_BYTES_MAX","crypto_kdf_hkdf_sha512_BYTES_MIN","crypto_kdf_hkdf_sha512_KEYBYTES","crypto_kx_PUBLICKEYBYTES","crypto_kx_SECRETKEYBYTES","crypto_kx_SEEDBYTES","crypto_kx_SESSIONKEYBYTES","crypto_onetimeauth_BYTES","crypto_onetimeauth_KEYBYTES","crypto_onetimeauth_poly1305_BYTES","crypto_onetimeauth_poly1305_KEYBYTES","crypto_pwhash_ALG_ARGON2I13","crypto_pwhash_ALG_ARGON2ID13","crypto_pwhash_ALG_DEFAULT","crypto_pwhash_BYTES_MAX","crypto_pwhash_BYTES_MIN","crypto_pwhash_MEMLIMIT_INTERACTIVE","crypto_pwhash_MEMLIMIT_MAX","crypto_pwhash_MEMLIMIT_MIN","crypto_pwhash_MEMLIMIT_MODERATE","crypto_pwhash_MEMLIMIT_SENSITIVE","crypto_pwhash_OPSLIMIT_INTERACTIVE","crypto_pwhash_OPSLIMIT_MAX","crypto_pwhash_OPSLIMIT_MIN","crypto_pwhash_OPSLIMIT_MODERATE","crypto_pwhash_OPSLIMIT_SENSITIVE","crypto_pwhash_PASSWD_MAX","crypto_pwhash_PASSWD_MIN","crypto_pwhash_SALTBYTES","crypto_pwhash_STRBYTES","crypto_pwhash_argon2i_BYTES_MAX","crypto_pwhash_argon2i_BYTES_MIN","crypto_pwhash_argon2i_MEMLIMIT_INTERACTIVE","crypto_pwhash_argon2i_MEMLIMIT_MAX","crypto_pwhash_argon2i_MEMLIMIT_MIN","crypto_pwhash_argon2i_MEMLIMIT_MODERATE","crypto_pwhash_argon2i_MEMLIMIT_SENSITIVE","crypto_pwhash_argon2i_OPSLIMIT_INTERACTIVE","crypto_pwhash_argon2i_OPSLIMIT_MAX","crypto_pwhash_argon2i_OPSLIMIT_MIN","crypto_pwhash_argon2i_OPSLIMIT_MODERATE","crypto_pwhash_argon2i_OPSLIMIT_SENSITIVE","crypto_pwhash_argon2i_PASSWD_MAX","crypto_pwhash_argon2i_PASSWD_MIN","crypto_pwhash_argon2i_SALTBYTES","crypto_pwhash_argon2i_STRBYTES","crypto_pwhash_argon2id_BYTES_MAX","crypto_pwhash_argon2id_BYTES_MIN","crypto_pwhash_argon2id_MEMLIMIT_INTERACTIVE","crypto_pwhash_argon2id_MEMLIMIT_MAX","crypto_pwhash_argon2id_MEMLIMIT_MIN","crypto_pwhash_argon2id_MEMLIMIT_MODERATE","crypto_pwhash_argon2id_MEMLIMIT_SENSITIVE","crypto_pwhash_argon2id_OPSLIMIT_INTERACTIVE","crypto_pwhash_argon2id_OPSLIMIT_MAX","crypto_pwhash_argon2id_OPSLIMIT_MIN","crypto_pwhash_argon2id_OPSLIMIT_MODERATE","crypto_pwhash_argon2id_OPSLIMIT_SENSITIVE","crypto_pwhash_argon2id_PASSWD_MAX","crypto_pwhash_argon2id_PASSWD_MIN","crypto_pwhash_argon2id_SALTBYTES","crypto_pwhash_argon2id_STRBYTES","crypto_pwhash_scryptsalsa208sha256_BYTES_MAX","crypto_pwhash_scryptsalsa208sha256_BYTES_MIN","crypto_pwhash_scryptsalsa208sha256_MEMLIMIT_INTERACTIVE","crypto_pwhash_scryptsalsa208sha256_MEMLIMIT_MAX","crypto_pwhash_scryptsalsa208sha256_MEMLIMIT_MIN","crypto_pwhash_scryptsalsa208sha256_MEMLIMIT_SENSITIVE","crypto_pwhash_scryptsalsa208sha256_OPSLIMIT_INTERACTIVE","crypto_pwhash_scryptsalsa208sha256_OPSLIMIT_MAX","crypto_pwhash_scryptsalsa208sha256_OPSLIMIT_MIN","crypto_pwhash_scryptsalsa208sha256_OPSLIMIT_SENSITIVE","crypto_pwhash_scryptsalsa208sha256_PASSWD_MAX","crypto_pwhash_scryptsalsa208sha256_PASSWD_MIN","crypto_pwhash_scryptsalsa208sha256_SALTBYTES","crypto_pwhash_scryptsalsa208sha256_STRBYTES","crypto_scalarmult_BYTES","crypto_scalarmult_SCALARBYTES","crypto_scalarmult_curve25519_BYTES","crypto_scalarmult_curve25519_SCALARBYTES","crypto_scalarmult_ed25519_BYTES","crypto_scalarmult_ed25519_SCALARBYTES","crypto_scalarmult_ristretto255_BYTES","crypto_scalarmult_ristretto255_SCALARBYTES","crypto_secretbox_KEYBYTES","crypto_secretbox_MACBYTES","crypto_secretbox_MESSAGEBYTES_MAX","crypto_secretbox_NONCEBYTES","crypto_secretbox_xchacha20poly1305_KEYBYTES","crypto_secretbox_xchacha20poly1305_MACBYTES","crypto_secretbox_xchacha20poly1305_MESSAGEBYTES_MAX","crypto_secretbox_xchacha20poly1305_NONCEBYTES","crypto_secretbox_xsalsa20poly1305_KEYBYTES","crypto_secretbox_xsalsa20poly1305_MACBYTES","crypto_secretbox_xsalsa20poly1305_MESSAGEBYTES_MAX","crypto_secretbox_xsalsa20poly1305_NONCEBYTES","crypto_secretstream_xchacha20poly1305_ABYTES","crypto_secretstream_xchacha20poly1305_HEADERBYTES","crypto_secretstream_xchacha20poly1305_KEYBYTES","crypto_secretstream_xchacha20poly1305_MESSAGEBYTES_MAX","crypto_secretstream_xchacha20poly1305_TAG_FINAL","crypto_secretstream_xchacha20poly1305_TAG_MESSAGE","crypto_secretstream_xchacha20poly1305_TAG_PUSH","crypto_secretstream_xchacha20poly1305_TAG_REKEY","crypto_shorthash_BYTES","crypto_shorthash_KEYBYTES","crypto_shorthash_siphash24_BYTES","crypto_shorthash_siphash24_KEYBYTES","crypto_shorthash_siphashx24_BYTES","crypto_shorthash_siphashx24_KEYBYTES","crypto_sign_BYTES","crypto_sign_MESSAGEBYTES_MAX","crypto_sign_PUBLICKEYBYTES","crypto_sign_SECRETKEYBYTES","crypto_sign_SEEDBYTES","crypto_sign_ed25519_BYTES","crypto_sign_ed25519_MESSAGEBYTES_MAX","crypto_sign_ed25519_PUBLICKEYBYTES","crypto_sign_ed25519_SECRETKEYBYTES","crypto_sign_ed25519_SEEDBYTES","crypto_stream_KEYBYTES","crypto_stream_MESSAGEBYTES_MAX","crypto_stream_NONCEBYTES","crypto_stream_chacha20_IETF_KEYBYTES","crypto_stream_chacha20_IETF_MESSAGEBYTES_MAX","crypto_stream_chacha20_IETF_NONCEBYTES","crypto_stream_chacha20_KEYBYTES","crypto_stream_chacha20_MESSAGEBYTES_MAX","crypto_stream_chacha20_NONCEBYTES","crypto_stream_chacha20_ietf_KEYBYTES","crypto_stream_chacha20_ietf_MESSAGEBYTES_MAX","crypto_stream_chacha20_ietf_NONCEBYTES","crypto_stream_salsa2012_KEYBYTES","crypto_stream_salsa2012_MESSAGEBYTES_MAX","crypto_stream_salsa2012_NONCEBYTES","crypto_stream_salsa208_KEYBYTES","crypto_stream_salsa208_MESSAGEBYTES_MAX","crypto_stream_salsa208_NONCEBYTES","crypto_stream_salsa20_KEYBYTES","crypto_stream_salsa20_MESSAGEBYTES_MAX","crypto_stream_salsa20_NONCEBYTES","crypto_stream_xchacha20_KEYBYTES","crypto_stream_xchacha20_MESSAGEBYTES_MAX","crypto_stream_xchacha20_NONCEBYTES","crypto_stream_xsalsa20_KEYBYTES","crypto_stream_xsalsa20_MESSAGEBYTES_MAX","crypto_stream_xsalsa20_NONCEBYTES","crypto_verify_16_BYTES","crypto_verify_32_BYTES","crypto_verify_64_BYTES"];for(_=0;_<n.length;_++)"function"==typeof(c=a["_"+n[_].toLowerCase()])&&(r[n[_]]=c());var s=["SODIUM_VERSION_STRING","crypto_pwhash_STRPREFIX","crypto_pwhash_argon2i_STRPREFIX","crypto_pwhash_argon2id_STRPREFIX","crypto_pwhash_scryptsalsa208sha256_STRPREFIX"];for(_=0;_<s.length;_++){var c;"function"==typeof(c=a["_"+s[_].toLowerCase()])&&(r[s[_]]=a.UTF8ToString(c()))}}a=e;try{t();var _=new Uint8Array([98,97,108,108,115]),n=r.randombytes_buf(r.crypto_secretbox_NONCEBYTES),s=r.randombytes_buf(r.crypto_secretbox_KEYBYTES),c=r.crypto_secretbox_easy(_,n,s),h=r.crypto_secretbox_open_easy(c,n,s);if(r.memcmp(_,h))return}catch(e){if(null==a.useBackupModule)throw new Error("Both wasm and asm failed to load"+e)}a.useBackupModule(),t()});function _(){return Object.keys(r).sort()}function n(e){if(!(e instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be incremented");for(var a=256,r=0,t=e.length;r<t;r++)a>>=8,a+=e[r],e[r]=255&a}function s(e,a){if(!(e instanceof Uint8Array&&a instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be added");var r=e.length,t=0,_=0;if(a.length!==e.length)throw new TypeError("Arguments must have the same length");for(_=0;_<r;_++)t>>=8,t+=e[_]+a[_],e[_]=255&t}function c(e){if(!(e instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be checked");for(var a=0,r=0,t=e.length;r<t;r++)a|=e[r];return 0===a}function h(e){if(!(e instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be wiped");for(var a=0,r=e.length;a<r;a++)e[a]=0}function o(e,a){if(!(e instanceof Uint8Array&&a instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be compared");if(e.length!==a.length)throw new TypeError("Only instances of identical length can be compared");for(var r=0,t=0,_=e.length;t<_;t++)r|=e[t]^a[t];return 0===r}function p(e,a){if(!(e instanceof Uint8Array&&a instanceof Uint8Array))throw new TypeError("Only Uint8Array instances can be compared");if(e.length!==a.length)throw new TypeError("Only instances of identical length can be compared");for(var r=0,t=1,_=e.length;_-- >0;)r|=a[_]-e[_]>>8&t,t&=(a[_]^e[_])-1>>8;return r+r+t-1}function y(e,r){if(!(e instanceof Uint8Array))throw new TypeError("buffer must be a Uint8Array");if((r|=0)<=0)throw new Error("block size must be > 0");var t,_=[],n=Y(4),s=1,c=0,h=0|e.length,o=new T(h+r);_.push(n),_.push(o.address);for(var p=o.address,y=o.address+h+r;p<y;p++)a.HEAPU8[p]=e[c],c+=s=1&~((65535&((h-=s)>>>48|h>>>32|h>>>16|h))-1>>16);return 0!==a._sodium_pad(n,o.address,e.length,r,o.length)&&M(_,"internal error"),o.length=a.getValue(n,"i32"),t=o.to_Uint8Array(),A(_),t}function i(e,r){if(!(e instanceof Uint8Array))throw new TypeError("buffer must be a Uint8Array");if((r|=0)<=0)throw new Error("block size must be > 0");var t=[],_=w(e),n=Y(4);return t.push(_),t.push(n),0!==a._sodium_unpad(n,_,e.length,r)&&M(t,"unsupported/invalid padding"),e=(e=new Uint8Array(e)).subarray(0,a.getValue(n,"i32")),A(t),e}function l(e){if("function"==typeof TextEncoder)return(new TextEncoder).encode(e);e=unescape(encodeURIComponent(e));for(var a=new Uint8Array(e.length),r=0,t=e.length;r<t;r++)a[r]=e.charCodeAt(r);return a}function u(e){if("function"==typeof TextDecoder)return new TextDecoder("utf-8",{fatal:!0}).decode(e);var a=8192,r=Math.ceil(e.length/a);if(r<=1)try{return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}catch(e){throw new TypeError("The encoded data was not valid.")}for(var t="",_=0,n=0;n<r;n++){var s=Array.prototype.slice.call(e,n*a+_,(n+1)*a+_);if(0!==s.length){var c,h=s.length,o=0;do{var p=s[--h];p>=240?(o=4,c=!0):p>=224?(o=3,c=!0):p>=192?(o=2,c=!0):p<128&&(o=1,c=!0)}while(!c);for(var y=o-(s.length-h),i=0;i<y;i++)_--,s.pop();t+=u(s)}}return t}function d(e){var r,t=[],_=new T((e=N(t,e,"input")).length/2),n=w(e),s=Y(4);return t.push(n),t.push(_.address),t.push(s),0!==a._sodium_hex2bin(_.address,_.length,n,e.length,0,0,s)&&M(t,"invalid input"),a.getValue(s,"i32")-n!==e.length&&M(t,"incomplete input"),r=_.to_Uint8Array(),A(t),r}function v(e){e=N(null,e,"input");for(var a,r,t,_="",n=0;n<e.length;n++)t=87+(r=15&e[n])+(r-10>>8&-39)<<8|87+(a=e[n]>>>4)+(a-10>>8&-39),_+=String.fromCharCode(255&t)+String.fromCharCode(t>>>8);return _}var g={ORIGINAL:1,ORIGINAL_NO_PADDING:3,URLSAFE:5,URLSAFE_NO_PADDING:7};function b(e){if(void 0===e)return g.URLSAFE_NO_PADDING;if(e!==g.ORIGINAL&&e!==g.ORIGINAL_NO_PADDING&&e!==g.URLSAFE&&e!==g.URLSAFE_NO_PADDING)throw new Error("unsupported base64 variant");return e}function f(e,r){r=b(r);var t,_=[],n=new T(3*(e=N(_,e,"input")).length/4),s=w(e),c=Y(4),h=Y(4);return _.push(s),_.push(n.address),_.push(c),_.push(h),0!==a._sodium_base642bin(n.address,n.length,s,e.length,0,c,h,r)&&M(_,"invalid input"),a.getValue(h,"i32")-s!==e.length&&M(_,"incomplete input"),n.length=a.getValue(c,"i32"),t=n.to_Uint8Array(),A(_),t}function m(e,r){r=b(r);var t=[];e=N(t,e,"input");var _,n=0|Math.floor(e.length/3),s=e.length-3*n,c=4*n+(0!==s?2&r?2+(s>>>1):4:0),h=new T(c+1),o=w(e);return t.push(o),t.push(h.address),0===a._sodium_bin2base64(h.address,h.length,o,e.length,r)&&M(t,"conversion failed"),h.length=c,_=u(h.to_Uint8Array()),A(t),_}function E(){return["uint8array","text","hex","base64"]}function x(e,a){var r=a||"uint8array";if(!k(r))throw new Error(r+" output format is not available");if(e instanceof T){if("uint8array"===r)return e.to_Uint8Array();if("text"===r)return u(e.to_Uint8Array());if("hex"===r)return v(e.to_Uint8Array());if("base64"===r)return m(e.to_Uint8Array(),g.URLSAFE_NO_PADDING);throw new Error('What is output format "'+r+'"?')}if("object"==typeof e){for(var t=Object.keys(e),_={},n=0;n<t.length;n++)_[t[n]]=x(e[t[n]],r);return _}if("string"==typeof e)return e;throw new TypeError("Cannot format output")}function k(e){for(var a=["uint8array","text","hex","base64"],r=0;r<a.length;r++)if(a[r]===e)return!0;return!1}function S(e){if(e){if("string"!=typeof e)throw new TypeError("When defined, the output format must be a string");if(!k(e))throw new Error(e+" is not a supported output format")}}function T(e){this.length=e,this.address=Y(e)}function w(e){var r=Y(e.length);return a.HEAPU8.set(e,r),r}function Y(e){var r=a._malloc(e);if(0===r)throw{message:"_malloc() failed",length:e};return r}function B(e){a._free(e)}function A(e){if(e)for(var a=0;a<e.length;a++)B(e[a])}function M(e,a){throw A(e),new Error(a)}function I(e,a){throw A(e),new TypeError(a)}function K(e,a,r){null==a&&I(e,r+" cannot be null or undefined")}function N(e,a,r){return K(e,a,r),a instanceof Uint8Array?a:"string"==typeof a?l(a):void I(e,"unsupported input type for "+r)}function L(e,r,t,_,n,s){var c=[];S(s);var h=null;null!=e&&(h=w(e=N(c,e,"secret_nonce")),e.length,c.push(h)),r=N(c,r,"ciphertext");var o,p=a._crypto_aead_aegis128l_abytes(),y=r.length;y<p&&I(c,"ciphertext is too short"),o=w(r),c.push(o);var i=null,l=0;null!=t&&(i=w(t=N(c,t,"additional_data")),l=t.length,c.push(i)),_=N(c,_,"public_nonce");var u,d=0|a._crypto_aead_aegis128l_npubbytes();_.length!==d&&I(c,"invalid public_nonce length"),u=w(_),c.push(u),n=N(c,n,"key");var v,g=0|a._crypto_aead_aegis128l_keybytes();n.length!==g&&I(c,"invalid key length"),v=w(n),c.push(v);var b=new T(y-a._crypto_aead_aegis128l_abytes()|0),f=b.address;if(c.push(f),0===a._crypto_aead_aegis128l_decrypt(f,null,h,o,y,0,i,l,0,u,v)){var m=x(b,s);return A(c),m}M(c,"ciphertext cannot be decrypted using that key")}function O(e,r,t,_,n,s,c){var h=[];S(c);var o=null;null!=e&&(o=w(e=N(h,e,"secret_nonce")),e.length,h.push(o));var p=w(r=N(h,r,"ciphertext")),y=r.length;h.push(p),t=N(h,t,"mac");var i,l=0|a._crypto_box_macbytes();t.length!==l&&I(h,"invalid mac length"),i=w(t),h.push(i);var u=null,d=0;null!=_&&(u=w(_=N(h,_,"additional_data")),d=_.length,h.push(u)),n=N(h,n,"public_nonce");var v,g=0|a._crypto_aead_aegis128l_npubbytes();n.length!==g&&I(h,"invalid public_nonce length"),v=w(n),h.push(v),s=N(h,s,"key");var b,f=0|a._crypto_aead_aegis128l_keybytes();s.length!==f&&I(h,"invalid key length"),b=w(s),h.push(b);var m=new T(0|y),E=m.address;if(h.push(E),0===a._crypto_aead_aegis128l_decrypt_detached(E,o,p,y,0,i,u,d,0,v,b)){var k=x(m,c);return A(h),k}M(h,"ciphertext cannot be decrypted using that key")}function U(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_aegis128l_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_aegis128l_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(o+a._crypto_aead_aegis128l_abytes()|0),b=g.address;if(c.push(b),0===a._crypto_aead_aegis128l_encrypt(b,null,h,o,0,p,y,0,i,l,d)){var f=x(g,s);return A(c),f}M(c,"invalid usage")}function C(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_aegis128l_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_aegis128l_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(0|o),b=g.address;c.push(b);var f=new T(0|a._crypto_aead_aegis128l_abytes()),m=f.address;if(c.push(m),0===a._crypto_aead_aegis128l_encrypt_detached(b,m,null,h,o,0,p,y,0,i,l,d)){var E=x({ciphertext:g,mac:f},s);return A(c),E}M(c,"invalid usage")}function P(e){var r=[];S(e);var t=new T(0|a._crypto_aead_aegis128l_keybytes()),_=t.address;r.push(_),a._crypto_aead_aegis128l_keygen(_);var n=x(t,e);return A(r),n}function R(e,r,t,_,n,s){var c=[];S(s);var h=null;null!=e&&(h=w(e=N(c,e,"secret_nonce")),e.length,c.push(h)),r=N(c,r,"ciphertext");var o,p=a._crypto_aead_aegis256_abytes(),y=r.length;y<p&&I(c,"ciphertext is too short"),o=w(r),c.push(o);var i=null,l=0;null!=t&&(i=w(t=N(c,t,"additional_data")),l=t.length,c.push(i)),_=N(c,_,"public_nonce");var u,d=0|a._crypto_aead_aegis256_npubbytes();_.length!==d&&I(c,"invalid public_nonce length"),u=w(_),c.push(u),n=N(c,n,"key");var v,g=0|a._crypto_aead_aegis256_keybytes();n.length!==g&&I(c,"invalid key length"),v=w(n),c.push(v);var b=new T(y-a._crypto_aead_aegis256_abytes()|0),f=b.address;if(c.push(f),0===a._crypto_aead_aegis256_decrypt(f,null,h,o,y,0,i,l,0,u,v)){var m=x(b,s);return A(c),m}M(c,"ciphertext cannot be decrypted using that key")}function X(e,r,t,_,n,s,c){var h=[];S(c);var o=null;null!=e&&(o=w(e=N(h,e,"secret_nonce")),e.length,h.push(o));var p=w(r=N(h,r,"ciphertext")),y=r.length;h.push(p),t=N(h,t,"mac");var i,l=0|a._crypto_box_macbytes();t.length!==l&&I(h,"invalid mac length"),i=w(t),h.push(i);var u=null,d=0;null!=_&&(u=w(_=N(h,_,"additional_data")),d=_.length,h.push(u)),n=N(h,n,"public_nonce");var v,g=0|a._crypto_aead_aegis256_npubbytes();n.length!==g&&I(h,"invalid public_nonce length"),v=w(n),h.push(v),s=N(h,s,"key");var b,f=0|a._crypto_aead_aegis256_keybytes();s.length!==f&&I(h,"invalid key length"),b=w(s),h.push(b);var m=new T(0|y),E=m.address;if(h.push(E),0===a._crypto_aead_aegis256_decrypt_detached(E,o,p,y,0,i,u,d,0,v,b)){var k=x(m,c);return A(h),k}M(h,"ciphertext cannot be decrypted using that key")}function G(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_aegis256_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_aegis256_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(o+a._crypto_aead_aegis256_abytes()|0),b=g.address;if(c.push(b),0===a._crypto_aead_aegis256_encrypt(b,null,h,o,0,p,y,0,i,l,d)){var f=x(g,s);return A(c),f}M(c,"invalid usage")}function D(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_aegis256_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_aegis256_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(0|o),b=g.address;c.push(b);var f=new T(0|a._crypto_aead_aegis256_abytes()),m=f.address;if(c.push(m),0===a._crypto_aead_aegis256_encrypt_detached(b,m,null,h,o,0,p,y,0,i,l,d)){var E=x({ciphertext:g,mac:f},s);return A(c),E}M(c,"invalid usage")}function F(e){var r=[];S(e);var t=new T(0|a._crypto_aead_aegis256_keybytes()),_=t.address;r.push(_),a._crypto_aead_aegis256_keygen(_);var n=x(t,e);return A(r),n}function V(e,r,t,_,n,s){var c=[];S(s);var h=null;null!=e&&(h=w(e=N(c,e,"secret_nonce")),e.length,c.push(h)),r=N(c,r,"ciphertext");var o,p=a._crypto_aead_chacha20poly1305_abytes(),y=r.length;y<p&&I(c,"ciphertext is too short"),o=w(r),c.push(o);var i=null,l=0;null!=t&&(i=w(t=N(c,t,"additional_data")),l=t.length,c.push(i)),_=N(c,_,"public_nonce");var u,d=0|a._crypto_aead_chacha20poly1305_npubbytes();_.length!==d&&I(c,"invalid public_nonce length"),u=w(_),c.push(u),n=N(c,n,"key");var v,g=0|a._crypto_aead_chacha20poly1305_keybytes();n.length!==g&&I(c,"invalid key length"),v=w(n),c.push(v);var b=new T(y-a._crypto_aead_chacha20poly1305_abytes()|0),f=b.address;if(c.push(f),0===a._crypto_aead_chacha20poly1305_decrypt(f,null,h,o,y,0,i,l,0,u,v)){var m=x(b,s);return A(c),m}M(c,"ciphertext cannot be decrypted using that key")}function H(e,r,t,_,n,s,c){var h=[];S(c);var o=null;null!=e&&(o=w(e=N(h,e,"secret_nonce")),e.length,h.push(o));var p=w(r=N(h,r,"ciphertext")),y=r.length;h.push(p),t=N(h,t,"mac");var i,l=0|a._crypto_box_macbytes();t.length!==l&&I(h,"invalid mac length"),i=w(t),h.push(i);var u=null,d=0;null!=_&&(u=w(_=N(h,_,"additional_data")),d=_.length,h.push(u)),n=N(h,n,"public_nonce");var v,g=0|a._crypto_aead_chacha20poly1305_npubbytes();n.length!==g&&I(h,"invalid public_nonce length"),v=w(n),h.push(v),s=N(h,s,"key");var b,f=0|a._crypto_aead_chacha20poly1305_keybytes();s.length!==f&&I(h,"invalid key length"),b=w(s),h.push(b);var m=new T(0|y),E=m.address;if(h.push(E),0===a._crypto_aead_chacha20poly1305_decrypt_detached(E,o,p,y,0,i,u,d,0,v,b)){var k=x(m,c);return A(h),k}M(h,"ciphertext cannot be decrypted using that key")}function W(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_chacha20poly1305_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_chacha20poly1305_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(o+a._crypto_aead_chacha20poly1305_abytes()|0),b=g.address;if(c.push(b),0===a._crypto_aead_chacha20poly1305_encrypt(b,null,h,o,0,p,y,0,i,l,d)){var f=x(g,s);return A(c),f}M(c,"invalid usage")}function q(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_chacha20poly1305_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_chacha20poly1305_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(0|o),b=g.address;c.push(b);var f=new T(0|a._crypto_aead_chacha20poly1305_abytes()),m=f.address;if(c.push(m),0===a._crypto_aead_chacha20poly1305_encrypt_detached(b,m,null,h,o,0,p,y,0,i,l,d)){var E=x({ciphertext:g,mac:f},s);return A(c),E}M(c,"invalid usage")}function z(e,r,t,_,n,s){var c=[];S(s);var h=null;null!=e&&(h=w(e=N(c,e,"secret_nonce")),e.length,c.push(h)),r=N(c,r,"ciphertext");var o,p=a._crypto_aead_chacha20poly1305_ietf_abytes(),y=r.length;y<p&&I(c,"ciphertext is too short"),o=w(r),c.push(o);var i=null,l=0;null!=t&&(i=w(t=N(c,t,"additional_data")),l=t.length,c.push(i)),_=N(c,_,"public_nonce");var u,d=0|a._crypto_aead_chacha20poly1305_ietf_npubbytes();_.length!==d&&I(c,"invalid public_nonce length"),u=w(_),c.push(u),n=N(c,n,"key");var v,g=0|a._crypto_aead_chacha20poly1305_ietf_keybytes();n.length!==g&&I(c,"invalid key length"),v=w(n),c.push(v);var b=new T(y-a._crypto_aead_chacha20poly1305_ietf_abytes()|0),f=b.address;if(c.push(f),0===a._crypto_aead_chacha20poly1305_ietf_decrypt(f,null,h,o,y,0,i,l,0,u,v)){var m=x(b,s);return A(c),m}M(c,"ciphertext cannot be decrypted using that key")}function j(e,r,t,_,n,s,c){var h=[];S(c);var o=null;null!=e&&(o=w(e=N(h,e,"secret_nonce")),e.length,h.push(o));var p=w(r=N(h,r,"ciphertext")),y=r.length;h.push(p),t=N(h,t,"mac");var i,l=0|a._crypto_box_macbytes();t.length!==l&&I(h,"invalid mac length"),i=w(t),h.push(i);var u=null,d=0;null!=_&&(u=w(_=N(h,_,"additional_data")),d=_.length,h.push(u)),n=N(h,n,"public_nonce");var v,g=0|a._crypto_aead_chacha20poly1305_ietf_npubbytes();n.length!==g&&I(h,"invalid public_nonce length"),v=w(n),h.push(v),s=N(h,s,"key");var b,f=0|a._crypto_aead_chacha20poly1305_ietf_keybytes();s.length!==f&&I(h,"invalid key length"),b=w(s),h.push(b);var m=new T(0|y),E=m.address;if(h.push(E),0===a._crypto_aead_chacha20poly1305_ietf_decrypt_detached(E,o,p,y,0,i,u,d,0,v,b)){var k=x(m,c);return A(h),k}M(h,"ciphertext cannot be decrypted using that key")}function J(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_chacha20poly1305_ietf_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_chacha20poly1305_ietf_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(o+a._crypto_aead_chacha20poly1305_ietf_abytes()|0),b=g.address;if(c.push(b),0===a._crypto_aead_chacha20poly1305_ietf_encrypt(b,null,h,o,0,p,y,0,i,l,d)){var f=x(g,s);return A(c),f}M(c,"invalid usage")}function Q(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_chacha20poly1305_ietf_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_chacha20poly1305_ietf_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(0|o),b=g.address;c.push(b);var f=new T(0|a._crypto_aead_chacha20poly1305_ietf_abytes()),m=f.address;if(c.push(m),0===a._crypto_aead_chacha20poly1305_ietf_encrypt_detached(b,m,null,h,o,0,p,y,0,i,l,d)){var E=x({ciphertext:g,mac:f},s);return A(c),E}M(c,"invalid usage")}function Z(e){var r=[];S(e);var t=new T(0|a._crypto_aead_chacha20poly1305_ietf_keybytes()),_=t.address;r.push(_),a._crypto_aead_chacha20poly1305_ietf_keygen(_);var n=x(t,e);return A(r),n}function $(e){var r=[];S(e);var t=new T(0|a._crypto_aead_chacha20poly1305_keybytes()),_=t.address;r.push(_),a._crypto_aead_chacha20poly1305_keygen(_);var n=x(t,e);return A(r),n}function ee(e,r,t,_,n,s){var c=[];S(s);var h=null;null!=e&&(h=w(e=N(c,e,"secret_nonce")),e.length,c.push(h)),r=N(c,r,"ciphertext");var o,p=a._crypto_aead_xchacha20poly1305_ietf_abytes(),y=r.length;y<p&&I(c,"ciphertext is too short"),o=w(r),c.push(o);var i=null,l=0;null!=t&&(i=w(t=N(c,t,"additional_data")),l=t.length,c.push(i)),_=N(c,_,"public_nonce");var u,d=0|a._crypto_aead_xchacha20poly1305_ietf_npubbytes();_.length!==d&&I(c,"invalid public_nonce length"),u=w(_),c.push(u),n=N(c,n,"key");var v,g=0|a._crypto_aead_xchacha20poly1305_ietf_keybytes();n.length!==g&&I(c,"invalid key length"),v=w(n),c.push(v);var b=new T(y-a._crypto_aead_xchacha20poly1305_ietf_abytes()|0),f=b.address;if(c.push(f),0===a._crypto_aead_xchacha20poly1305_ietf_decrypt(f,null,h,o,y,0,i,l,0,u,v)){var m=x(b,s);return A(c),m}M(c,"ciphertext cannot be decrypted using that key")}function ae(e,r,t,_,n,s,c){var h=[];S(c);var o=null;null!=e&&(o=w(e=N(h,e,"secret_nonce")),e.length,h.push(o));var p=w(r=N(h,r,"ciphertext")),y=r.length;h.push(p),t=N(h,t,"mac");var i,l=0|a._crypto_box_macbytes();t.length!==l&&I(h,"invalid mac length"),i=w(t),h.push(i);var u=null,d=0;null!=_&&(u=w(_=N(h,_,"additional_data")),d=_.length,h.push(u)),n=N(h,n,"public_nonce");var v,g=0|a._crypto_aead_xchacha20poly1305_ietf_npubbytes();n.length!==g&&I(h,"invalid public_nonce length"),v=w(n),h.push(v),s=N(h,s,"key");var b,f=0|a._crypto_aead_xchacha20poly1305_ietf_keybytes();s.length!==f&&I(h,"invalid key length"),b=w(s),h.push(b);var m=new T(0|y),E=m.address;if(h.push(E),0===a._crypto_aead_xchacha20poly1305_ietf_decrypt_detached(E,o,p,y,0,i,u,d,0,v,b)){var k=x(m,c);return A(h),k}M(h,"ciphertext cannot be decrypted using that key")}function re(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_xchacha20poly1305_ietf_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_xchacha20poly1305_ietf_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(o+a._crypto_aead_xchacha20poly1305_ietf_abytes()|0),b=g.address;if(c.push(b),0===a._crypto_aead_xchacha20poly1305_ietf_encrypt(b,null,h,o,0,p,y,0,i,l,d)){var f=x(g,s);return A(c),f}M(c,"invalid usage")}function te(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"message")),o=e.length;c.push(h);var p=null,y=0;null!=r&&(p=w(r=N(c,r,"additional_data")),y=r.length,c.push(p));var i=null;null!=t&&(i=w(t=N(c,t,"secret_nonce")),t.length,c.push(i)),_=N(c,_,"public_nonce");var l,u=0|a._crypto_aead_xchacha20poly1305_ietf_npubbytes();_.length!==u&&I(c,"invalid public_nonce length"),l=w(_),c.push(l),n=N(c,n,"key");var d,v=0|a._crypto_aead_xchacha20poly1305_ietf_keybytes();n.length!==v&&I(c,"invalid key length"),d=w(n),c.push(d);var g=new T(0|o),b=g.address;c.push(b);var f=new T(0|a._crypto_aead_xchacha20poly1305_ietf_abytes()),m=f.address;if(c.push(m),0===a._crypto_aead_xchacha20poly1305_ietf_encrypt_detached(b,m,null,h,o,0,p,y,0,i,l,d)){var E=x({ciphertext:g,mac:f},s);return A(c),E}M(c,"invalid usage")}function _e(e){var r=[];S(e);var t=new T(0|a._crypto_aead_xchacha20poly1305_ietf_keybytes()),_=t.address;r.push(_),a._crypto_aead_xchacha20poly1305_ietf_keygen(_);var n=x(t,e);return A(r),n}function ne(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_auth_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_auth_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_auth(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function se(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_auth_hmacsha256_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_auth_hmacsha256_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_auth_hmacsha256(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function ce(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_auth_hmacsha256_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_auth_hmacsha256_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function he(e,r){var t=[];S(r);var _=null,n=0;null!=e&&(_=w(e=N(t,e,"key")),n=e.length,t.push(_));var s=new T(208).address;if(!(0|a._crypto_auth_hmacsha256_init(s,_,n))){var c=s;return A(t),c}M(t,"invalid usage")}function oe(e){var r=[];S(e);var t=new T(0|a._crypto_auth_hmacsha256_keybytes()),_=t.address;r.push(_),a._crypto_auth_hmacsha256_keygen(_);var n=x(t,e);return A(r),n}function pe(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_auth_hmacsha256_update(e,n,s)&&M(_,"invalid usage"),A(_)}function ye(e,r,t){var _=[];e=N(_,e,"tag");var n,s=0|a._crypto_auth_hmacsha256_bytes();e.length!==s&&I(_,"invalid tag length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"key");var o,p=0|a._crypto_auth_hmacsha256_keybytes();t.length!==p&&I(_,"invalid key length"),o=w(t),_.push(o);var y=!(0|a._crypto_auth_hmacsha256_verify(n,c,h,0,o));return A(_),y}function ie(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_auth_hmacsha512_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_auth_hmacsha512_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_auth_hmacsha512(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function le(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_auth_hmacsha512256_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_auth_hmacsha512256_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_auth_hmacsha512256(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function ue(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_auth_hmacsha512256_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_auth_hmacsha512256_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function de(e,r){var t=[];S(r);var _=null,n=0;null!=e&&(_=w(e=N(t,e,"key")),n=e.length,t.push(_));var s=new T(416).address;if(!(0|a._crypto_auth_hmacsha512256_init(s,_,n))){var c=s;return A(t),c}M(t,"invalid usage")}function ve(e){var r=[];S(e);var t=new T(0|a._crypto_auth_hmacsha512256_keybytes()),_=t.address;r.push(_),a._crypto_auth_hmacsha512256_keygen(_);var n=x(t,e);return A(r),n}function ge(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_auth_hmacsha512256_update(e,n,s)&&M(_,"invalid usage"),A(_)}function be(e,r,t){var _=[];e=N(_,e,"tag");var n,s=0|a._crypto_auth_hmacsha512256_bytes();e.length!==s&&I(_,"invalid tag length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"key");var o,p=0|a._crypto_auth_hmacsha512256_keybytes();t.length!==p&&I(_,"invalid key length"),o=w(t),_.push(o);var y=!(0|a._crypto_auth_hmacsha512256_verify(n,c,h,0,o));return A(_),y}function fe(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_auth_hmacsha512_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_auth_hmacsha512_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function me(e,r){var t=[];S(r);var _=null,n=0;null!=e&&(_=w(e=N(t,e,"key")),n=e.length,t.push(_));var s=new T(416).address;if(!(0|a._crypto_auth_hmacsha512_init(s,_,n))){var c=s;return A(t),c}M(t,"invalid usage")}function Ee(e){var r=[];S(e);var t=new T(0|a._crypto_auth_hmacsha512_keybytes()),_=t.address;r.push(_),a._crypto_auth_hmacsha512_keygen(_);var n=x(t,e);return A(r),n}function xe(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_auth_hmacsha512_update(e,n,s)&&M(_,"invalid usage"),A(_)}function ke(e,r,t){var _=[];e=N(_,e,"tag");var n,s=0|a._crypto_auth_hmacsha512_bytes();e.length!==s&&I(_,"invalid tag length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"key");var o,p=0|a._crypto_auth_hmacsha512_keybytes();t.length!==p&&I(_,"invalid key length"),o=w(t),_.push(o);var y=!(0|a._crypto_auth_hmacsha512_verify(n,c,h,0,o));return A(_),y}function Se(e){var r=[];S(e);var t=new T(0|a._crypto_auth_keybytes()),_=t.address;r.push(_),a._crypto_auth_keygen(_);var n=x(t,e);return A(r),n}function Te(e,r,t){var _=[];e=N(_,e,"tag");var n,s=0|a._crypto_auth_bytes();e.length!==s&&I(_,"invalid tag length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"key");var o,p=0|a._crypto_auth_keybytes();t.length!==p&&I(_,"invalid key length"),o=w(t),_.push(o);var y=!(0|a._crypto_auth_verify(n,c,h,0,o));return A(_),y}function we(e,r,t){var _=[];S(t),e=N(_,e,"publicKey");var n,s=0|a._crypto_box_publickeybytes();e.length!==s&&I(_,"invalid publicKey length"),n=w(e),_.push(n),r=N(_,r,"privateKey");var c,h=0|a._crypto_box_secretkeybytes();r.length!==h&&I(_,"invalid privateKey length"),c=w(r),_.push(c);var o=new T(0|a._crypto_box_beforenmbytes()),p=o.address;if(_.push(p),!(0|a._crypto_box_beforenm(p,n,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function Ye(e,r,t){var _=[];S(t),e=N(_,e,"publicKey");var n,s=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();e.length!==s&&I(_,"invalid publicKey length"),n=w(e),_.push(n),r=N(_,r,"privateKey");var c,h=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();r.length!==h&&I(_,"invalid privateKey length"),c=w(r),_.push(c);var o=new T(0|a._crypto_box_curve25519xchacha20poly1305_beforenmbytes()),p=o.address;if(_.push(p),!(0|a._crypto_box_curve25519xchacha20poly1305_beforenm(p,n,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function Be(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),t=N(s,t,"publicKey");var y,i=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();t.length!==i&&I(s,"invalid publicKey length"),y=w(t),s.push(y),_=N(s,_,"privateKey");var l,u=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();_.length!==u&&I(s,"invalid privateKey length"),l=w(_),s.push(l);var d=new T(0|h),v=d.address;s.push(v);var g=new T(0|a._crypto_box_curve25519xchacha20poly1305_macbytes()),b=g.address;if(s.push(b),!(0|a._crypto_box_curve25519xchacha20poly1305_detached(v,b,c,h,0,o,y,l))){var f=x({ciphertext:d,mac:g},n);return A(s),f}M(s,"invalid usage")}function Ae(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"sharedKey");var p,y=0|a._crypto_box_curve25519xchacha20poly1305_beforenmbytes();t.length!==y&&I(n,"invalid sharedKey length"),p=w(t),n.push(p);var i=new T(0|c),l=i.address;n.push(l);var u=new T(0|a._crypto_box_curve25519xchacha20poly1305_macbytes()),d=u.address;if(n.push(d),!(0|a._crypto_box_curve25519xchacha20poly1305_detached_afternm(l,d,s,c,0,h,p))){var v=x({ciphertext:i,mac:u},_);return A(n),v}M(n,"invalid usage")}function Me(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),t=N(s,t,"publicKey");var y,i=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();t.length!==i&&I(s,"invalid publicKey length"),y=w(t),s.push(y),_=N(s,_,"privateKey");var l,u=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();_.length!==u&&I(s,"invalid privateKey length"),l=w(_),s.push(l);var d=new T(h+a._crypto_box_curve25519xchacha20poly1305_macbytes()|0),v=d.address;if(s.push(v),!(0|a._crypto_box_curve25519xchacha20poly1305_easy(v,c,h,0,o,y,l))){var g=x(d,n);return A(s),g}M(s,"invalid usage")}function Ie(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"sharedKey");var p,y=0|a._crypto_box_curve25519xchacha20poly1305_beforenmbytes();t.length!==y&&I(n,"invalid sharedKey length"),p=w(t),n.push(p);var i=new T(c+a._crypto_box_curve25519xchacha20poly1305_macbytes()|0),l=i.address;if(n.push(l),!(0|a._crypto_box_curve25519xchacha20poly1305_easy_afternm(l,s,c,0,h,p))){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function Ke(e){var r=[];S(e);var t=new T(0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes()),_=t.address;r.push(_);var n=new T(0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes()),s=n.address;r.push(s),a._crypto_box_curve25519xchacha20poly1305_keypair(_,s);var c=x({publicKey:t,privateKey:n,keyType:"curve25519"},e);return A(r),c}function Ne(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"ciphertext")),o=e.length;c.push(h),r=N(c,r,"mac");var p,y=0|a._crypto_box_curve25519xchacha20poly1305_macbytes();r.length!==y&&I(c,"invalid mac length"),p=w(r),c.push(p),t=N(c,t,"nonce");var i,l=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();t.length!==l&&I(c,"invalid nonce length"),i=w(t),c.push(i),_=N(c,_,"publicKey");var u,d=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();_.length!==d&&I(c,"invalid publicKey length"),u=w(_),c.push(u),n=N(c,n,"privateKey");var v,g=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();n.length!==g&&I(c,"invalid privateKey length"),v=w(n),c.push(v);var b=new T(0|o),f=b.address;if(c.push(f),!(0|a._crypto_box_curve25519xchacha20poly1305_open_detached(f,h,p,o,0,i,u,v))){var m=x(b,s);return A(c),m}M(c,"incorrect key pair for the given ciphertext")}function Le(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"ciphertext")),h=e.length;s.push(c),r=N(s,r,"mac");var o,p=0|a._crypto_box_curve25519xchacha20poly1305_macbytes();r.length!==p&&I(s,"invalid mac length"),o=w(r),s.push(o),t=N(s,t,"nonce");var y,i=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();t.length!==i&&I(s,"invalid nonce length"),y=w(t),s.push(y),_=N(s,_,"sharedKey");var l,u=0|a._crypto_box_curve25519xchacha20poly1305_beforenmbytes();_.length!==u&&I(s,"invalid sharedKey length"),l=w(_),s.push(l);var d=new T(0|h),v=d.address;if(s.push(v),!(0|a._crypto_box_curve25519xchacha20poly1305_open_detached_afternm(v,c,o,h,0,y,l))){var g=x(d,n);return A(s),g}M(s,"incorrect secret key for the given ciphertext")}function Oe(e,r,t,_,n){var s=[];S(n),e=N(s,e,"ciphertext");var c,h=a._crypto_box_curve25519xchacha20poly1305_macbytes(),o=e.length;o<h&&I(s,"ciphertext is too short"),c=w(e),s.push(c),r=N(s,r,"nonce");var p,y=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==y&&I(s,"invalid nonce length"),p=w(r),s.push(p),t=N(s,t,"publicKey");var i,l=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();t.length!==l&&I(s,"invalid publicKey length"),i=w(t),s.push(i),_=N(s,_,"privateKey");var u,d=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();_.length!==d&&I(s,"invalid privateKey length"),u=w(_),s.push(u);var v=new T(o-a._crypto_box_curve25519xchacha20poly1305_macbytes()|0),g=v.address;if(s.push(g),!(0|a._crypto_box_curve25519xchacha20poly1305_open_easy(g,c,o,0,p,i,u))){var b=x(v,n);return A(s),b}M(s,"incorrect key pair for the given ciphertext")}function Ue(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"ciphertext")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_box_curve25519xchacha20poly1305_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"sharedKey");var p,y=0|a._crypto_box_curve25519xchacha20poly1305_beforenmbytes();t.length!==y&&I(n,"invalid sharedKey length"),p=w(t),n.push(p);var i=new T(c-a._crypto_box_curve25519xchacha20poly1305_macbytes()|0),l=i.address;if(n.push(l),!(0|a._crypto_box_curve25519xchacha20poly1305_open_easy_afternm(l,s,c,0,h,p))){var u=x(i,_);return A(n),u}M(n,"incorrect secret key for the given ciphertext")}function Ce(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"publicKey");var c,h=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();r.length!==h&&I(_,"invalid publicKey length"),c=w(r),_.push(c);var o=new T(s+a._crypto_box_curve25519xchacha20poly1305_sealbytes()|0),p=o.address;_.push(p),a._crypto_box_curve25519xchacha20poly1305_seal(p,n,s,0,c);var y=x(o,t);return A(_),y}function Pe(e,r,t,_){var n=[];S(_),e=N(n,e,"ciphertext");var s,c=a._crypto_box_curve25519xchacha20poly1305_sealbytes(),h=e.length;h<c&&I(n,"ciphertext is too short"),s=w(e),n.push(s),r=N(n,r,"publicKey");var o,p=0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes();r.length!==p&&I(n,"invalid publicKey length"),o=w(r),n.push(o),t=N(n,t,"secretKey");var y,i=0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes();t.length!==i&&I(n,"invalid secretKey length"),y=w(t),n.push(y);var l=new T(h-a._crypto_box_curve25519xchacha20poly1305_sealbytes()|0),u=l.address;n.push(u),a._crypto_box_curve25519xchacha20poly1305_seal_open(u,s,h,0,o,y);var d=x(l,_);return A(n),d}function Re(e,r){var t=[];S(r),e=N(t,e,"seed");var _,n=0|a._crypto_box_curve25519xchacha20poly1305_seedbytes();e.length!==n&&I(t,"invalid seed length"),_=w(e),t.push(_);var s=new T(0|a._crypto_box_curve25519xchacha20poly1305_publickeybytes()),c=s.address;t.push(c);var h=new T(0|a._crypto_box_curve25519xchacha20poly1305_secretkeybytes()),o=h.address;if(t.push(o),!(0|a._crypto_box_curve25519xchacha20poly1305_seed_keypair(c,o,_))){var p={publicKey:x(s,r),privateKey:x(h,r),keyType:"x25519"};return A(t),p}M(t,"invalid usage")}function Xe(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_box_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),t=N(s,t,"publicKey");var y,i=0|a._crypto_box_publickeybytes();t.length!==i&&I(s,"invalid publicKey length"),y=w(t),s.push(y),_=N(s,_,"privateKey");var l,u=0|a._crypto_box_secretkeybytes();_.length!==u&&I(s,"invalid privateKey length"),l=w(_),s.push(l);var d=new T(0|h),v=d.address;s.push(v);var g=new T(0|a._crypto_box_macbytes()),b=g.address;if(s.push(b),!(0|a._crypto_box_detached(v,b,c,h,0,o,y,l))){var f=x({ciphertext:d,mac:g},n);return A(s),f}M(s,"invalid usage")}function Ge(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_box_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),t=N(s,t,"publicKey");var y,i=0|a._crypto_box_publickeybytes();t.length!==i&&I(s,"invalid publicKey length"),y=w(t),s.push(y),_=N(s,_,"privateKey");var l,u=0|a._crypto_box_secretkeybytes();_.length!==u&&I(s,"invalid privateKey length"),l=w(_),s.push(l);var d=new T(h+a._crypto_box_macbytes()|0),v=d.address;if(s.push(v),!(0|a._crypto_box_easy(v,c,h,0,o,y,l))){var g=x(d,n);return A(s),g}M(s,"invalid usage")}function De(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_box_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"sharedKey");var p,y=0|a._crypto_box_beforenmbytes();t.length!==y&&I(n,"invalid sharedKey length"),p=w(t),n.push(p);var i=new T(c+a._crypto_box_macbytes()|0),l=i.address;if(n.push(l),!(0|a._crypto_box_easy_afternm(l,s,c,0,h,p))){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function Fe(e){var r=[];S(e);var t=new T(0|a._crypto_box_publickeybytes()),_=t.address;r.push(_);var n=new T(0|a._crypto_box_secretkeybytes()),s=n.address;if(r.push(s),!(0|a._crypto_box_keypair(_,s))){var c={publicKey:x(t,e),privateKey:x(n,e),keyType:"x25519"};return A(r),c}M(r,"internal error")}function Ve(e,r,t,_,n,s){var c=[];S(s);var h=w(e=N(c,e,"ciphertext")),o=e.length;c.push(h),r=N(c,r,"mac");var p,y=0|a._crypto_box_macbytes();r.length!==y&&I(c,"invalid mac length"),p=w(r),c.push(p),t=N(c,t,"nonce");var i,l=0|a._crypto_box_noncebytes();t.length!==l&&I(c,"invalid nonce length"),i=w(t),c.push(i),_=N(c,_,"publicKey");var u,d=0|a._crypto_box_publickeybytes();_.length!==d&&I(c,"invalid publicKey length"),u=w(_),c.push(u),n=N(c,n,"privateKey");var v,g=0|a._crypto_box_secretkeybytes();n.length!==g&&I(c,"invalid privateKey length"),v=w(n),c.push(v);var b=new T(0|o),f=b.address;if(c.push(f),!(0|a._crypto_box_open_detached(f,h,p,o,0,i,u,v))){var m=x(b,s);return A(c),m}M(c,"incorrect key pair for the given ciphertext")}function He(e,r,t,_,n){var s=[];S(n),e=N(s,e,"ciphertext");var c,h=a._crypto_box_macbytes(),o=e.length;o<h&&I(s,"ciphertext is too short"),c=w(e),s.push(c),r=N(s,r,"nonce");var p,y=0|a._crypto_box_noncebytes();r.length!==y&&I(s,"invalid nonce length"),p=w(r),s.push(p),t=N(s,t,"publicKey");var i,l=0|a._crypto_box_publickeybytes();t.length!==l&&I(s,"invalid publicKey length"),i=w(t),s.push(i),_=N(s,_,"privateKey");var u,d=0|a._crypto_box_secretkeybytes();_.length!==d&&I(s,"invalid privateKey length"),u=w(_),s.push(u);var v=new T(o-a._crypto_box_macbytes()|0),g=v.address;if(s.push(g),!(0|a._crypto_box_open_easy(g,c,o,0,p,i,u))){var b=x(v,n);return A(s),b}M(s,"incorrect key pair for the given ciphertext")}function We(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"ciphertext")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_box_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"sharedKey");var p,y=0|a._crypto_box_beforenmbytes();t.length!==y&&I(n,"invalid sharedKey length"),p=w(t),n.push(p);var i=new T(c-a._crypto_box_macbytes()|0),l=i.address;if(n.push(l),!(0|a._crypto_box_open_easy_afternm(l,s,c,0,h,p))){var u=x(i,_);return A(n),u}M(n,"incorrect secret key for the given ciphertext")}function qe(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"publicKey");var c,h=0|a._crypto_box_publickeybytes();r.length!==h&&I(_,"invalid publicKey length"),c=w(r),_.push(c);var o=new T(s+a._crypto_box_sealbytes()|0),p=o.address;if(_.push(p),!(0|a._crypto_box_seal(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function ze(e,r,t,_){var n=[];S(_),e=N(n,e,"ciphertext");var s,c=a._crypto_box_sealbytes(),h=e.length;h<c&&I(n,"ciphertext is too short"),s=w(e),n.push(s),r=N(n,r,"publicKey");var o,p=0|a._crypto_box_publickeybytes();r.length!==p&&I(n,"invalid publicKey length"),o=w(r),n.push(o),t=N(n,t,"privateKey");var y,i=0|a._crypto_box_secretkeybytes();t.length!==i&&I(n,"invalid privateKey length"),y=w(t),n.push(y);var l=new T(h-a._crypto_box_sealbytes()|0),u=l.address;if(n.push(u),!(0|a._crypto_box_seal_open(u,s,h,0,o,y))){var d=x(l,_);return A(n),d}M(n,"incorrect key pair for the given ciphertext")}function je(e,r){var t=[];S(r),e=N(t,e,"seed");var _,n=0|a._crypto_box_seedbytes();e.length!==n&&I(t,"invalid seed length"),_=w(e),t.push(_);var s=new T(0|a._crypto_box_publickeybytes()),c=s.address;t.push(c);var h=new T(0|a._crypto_box_secretkeybytes()),o=h.address;if(t.push(o),!(0|a._crypto_box_seed_keypair(c,o,_))){var p={publicKey:x(s,r),privateKey:x(h,r),keyType:"x25519"};return A(t),p}M(t,"invalid usage")}function Je(e,r,t){var _=[];S(t),e=N(_,e,"p");var n,s=0|a._crypto_core_ed25519_bytes();e.length!==s&&I(_,"invalid p length"),n=w(e),_.push(n),r=N(_,r,"q");var c,h=0|a._crypto_core_ed25519_bytes();r.length!==h&&I(_,"invalid q length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ed25519_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_core_ed25519_add(p,n,c))){var y=x(o,t);return A(_),y}M(_,"input is an invalid element")}function Qe(e,r){var t=[];S(r);var _=w(e=N(t,e,"r"));e.length,t.push(_);var n=new T(0|a._crypto_core_ed25519_bytes()),s=n.address;if(t.push(s),!(0|a._crypto_core_ed25519_from_hash(s,_))){var c=x(n,r);return A(t),c}M(t,"invalid usage")}function Ze(e,r){var t=[];S(r);var _=w(e=N(t,e,"r"));e.length,t.push(_);var n=new T(0|a._crypto_core_ed25519_bytes()),s=n.address;if(t.push(s),!(0|a._crypto_core_ed25519_from_uniform(s,_))){var c=x(n,r);return A(t),c}M(t,"invalid usage")}function $e(e,r){var t=[];S(r),e=N(t,e,"repr");var _,n=0|a._crypto_core_ed25519_bytes();e.length!==n&&I(t,"invalid repr length"),_=w(e),t.push(_);var s=1==(0|a._crypto_core_ed25519_is_valid_point(_));return A(t),s}function ea(e){var r=[];S(e);var t=new T(0|a._crypto_core_ed25519_bytes()),_=t.address;r.push(_),a._crypto_core_ed25519_random(_);var n=x(t,e);return A(r),n}function aa(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ed25519_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ed25519_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ed25519_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ed25519_scalar_add(p,n,c);var y=x(o,t);return A(_),y}function ra(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ed25519_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ed25519_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ed25519_scalar_complement(c,_);var h=x(s,r);return A(t),h}function ta(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ed25519_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ed25519_scalarbytes()),c=s.address;if(t.push(c),!(0|a._crypto_core_ed25519_scalar_invert(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid reciprocate")}function _a(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ed25519_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ed25519_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ed25519_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ed25519_scalar_mul(p,n,c);var y=x(o,t);return A(_),y}function na(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ed25519_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ed25519_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ed25519_scalar_negate(c,_);var h=x(s,r);return A(t),h}function sa(e){var r=[];S(e);var t=new T(0|a._crypto_core_ed25519_scalarbytes()),_=t.address;r.push(_),a._crypto_core_ed25519_scalar_random(_);var n=x(t,e);return A(r),n}function ca(e,r){var t=[];S(r),e=N(t,e,"sample");var _,n=0|a._crypto_core_ed25519_nonreducedscalarbytes();e.length!==n&&I(t,"invalid sample length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ed25519_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ed25519_scalar_reduce(c,_);var h=x(s,r);return A(t),h}function ha(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ed25519_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ed25519_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ed25519_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ed25519_scalar_sub(p,n,c);var y=x(o,t);return A(_),y}function oa(e,r,t){var _=[];S(t),e=N(_,e,"p");var n,s=0|a._crypto_core_ed25519_bytes();e.length!==s&&I(_,"invalid p length"),n=w(e),_.push(n),r=N(_,r,"q");var c,h=0|a._crypto_core_ed25519_bytes();r.length!==h&&I(_,"invalid q length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ed25519_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_core_ed25519_sub(p,n,c))){var y=x(o,t);return A(_),y}M(_,"input is an invalid element")}function pa(e,r,t,_){var n=[];S(_),e=N(n,e,"input");var s,c=0|a._crypto_core_hchacha20_inputbytes();e.length!==c&&I(n,"invalid input length"),s=w(e),n.push(s),r=N(n,r,"privateKey");var h,o=0|a._crypto_core_hchacha20_keybytes();r.length!==o&&I(n,"invalid privateKey length"),h=w(r),n.push(h);var p=null;null!=t&&(p=w(t=N(n,t,"constant")),t.length,n.push(p));var y=new T(0|a._crypto_core_hchacha20_outputbytes()),i=y.address;if(n.push(i),!(0|a._crypto_core_hchacha20(i,s,h,p))){var l=x(y,_);return A(n),l}M(n,"invalid usage")}function ya(e,r,t,_){var n=[];S(_),e=N(n,e,"input");var s,c=0|a._crypto_core_hsalsa20_inputbytes();e.length!==c&&I(n,"invalid input length"),s=w(e),n.push(s),r=N(n,r,"privateKey");var h,o=0|a._crypto_core_hsalsa20_keybytes();r.length!==o&&I(n,"invalid privateKey length"),h=w(r),n.push(h);var p=null;null!=t&&(p=w(t=N(n,t,"constant")),t.length,n.push(p));var y=new T(0|a._crypto_core_hsalsa20_outputbytes()),i=y.address;if(n.push(i),!(0|a._crypto_core_hsalsa20(i,s,h,p))){var l=x(y,_);return A(n),l}M(n,"invalid usage")}function ia(e,r,t){var _=[];S(t),e=N(_,e,"p");var n,s=0|a._crypto_core_ristretto255_bytes();e.length!==s&&I(_,"invalid p length"),n=w(e),_.push(n),r=N(_,r,"q");var c,h=0|a._crypto_core_ristretto255_bytes();r.length!==h&&I(_,"invalid q length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ristretto255_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_core_ristretto255_add(p,n,c))){var y=x(o,t);return A(_),y}M(_,"input is an invalid element")}function la(e,r){var t=[];S(r);var _=w(e=N(t,e,"r"));e.length,t.push(_);var n=new T(0|a._crypto_core_ristretto255_bytes()),s=n.address;if(t.push(s),!(0|a._crypto_core_ristretto255_from_hash(s,_))){var c=x(n,r);return A(t),c}M(t,"invalid usage")}function ua(e,r){var t=[];S(r),e=N(t,e,"repr");var _,n=0|a._crypto_core_ristretto255_bytes();e.length!==n&&I(t,"invalid repr length"),_=w(e),t.push(_);var s=1==(0|a._crypto_core_ristretto255_is_valid_point(_));return A(t),s}function da(e){var r=[];S(e);var t=new T(0|a._crypto_core_ristretto255_bytes()),_=t.address;r.push(_),a._crypto_core_ristretto255_random(_);var n=x(t,e);return A(r),n}function va(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ristretto255_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ristretto255_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ristretto255_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ristretto255_scalar_add(p,n,c);var y=x(o,t);return A(_),y}function ga(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ristretto255_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ristretto255_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ristretto255_scalar_complement(c,_);var h=x(s,r);return A(t),h}function ba(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ristretto255_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ristretto255_scalarbytes()),c=s.address;if(t.push(c),!(0|a._crypto_core_ristretto255_scalar_invert(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid reciprocate")}function fa(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ristretto255_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ristretto255_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ristretto255_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ristretto255_scalar_mul(p,n,c);var y=x(o,t);return A(_),y}function ma(e,r){var t=[];S(r),e=N(t,e,"s");var _,n=0|a._crypto_core_ristretto255_scalarbytes();e.length!==n&&I(t,"invalid s length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ristretto255_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ristretto255_scalar_negate(c,_);var h=x(s,r);return A(t),h}function Ea(e){var r=[];S(e);var t=new T(0|a._crypto_core_ristretto255_scalarbytes()),_=t.address;r.push(_),a._crypto_core_ristretto255_scalar_random(_);var n=x(t,e);return A(r),n}function xa(e,r){var t=[];S(r),e=N(t,e,"sample");var _,n=0|a._crypto_core_ristretto255_nonreducedscalarbytes();e.length!==n&&I(t,"invalid sample length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ristretto255_scalarbytes()),c=s.address;t.push(c),a._crypto_core_ristretto255_scalar_reduce(c,_);var h=x(s,r);return A(t),h}function ka(e,r,t){var _=[];S(t),e=N(_,e,"x");var n,s=0|a._crypto_core_ristretto255_scalarbytes();e.length!==s&&I(_,"invalid x length"),n=w(e),_.push(n),r=N(_,r,"y");var c,h=0|a._crypto_core_ristretto255_scalarbytes();r.length!==h&&I(_,"invalid y length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ristretto255_scalarbytes()),p=o.address;_.push(p),a._crypto_core_ristretto255_scalar_sub(p,n,c);var y=x(o,t);return A(_),y}function Sa(e,r,t){var _=[];S(t),e=N(_,e,"p");var n,s=0|a._crypto_core_ristretto255_bytes();e.length!==s&&I(_,"invalid p length"),n=w(e),_.push(n),r=N(_,r,"q");var c,h=0|a._crypto_core_ristretto255_bytes();r.length!==h&&I(_,"invalid q length"),c=w(r),_.push(c);var o=new T(0|a._crypto_core_ristretto255_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_core_ristretto255_sub(p,n,c))){var y=x(o,t);return A(_),y}M(_,"input is an invalid element")}function Ta(e,r,t,_){var n=[];S(_),K(n,e,"hash_length"),("number"!=typeof e||(0|e)!==e||e<0)&&I(n,"hash_length must be an unsigned integer");var s=w(r=N(n,r,"message")),c=r.length;n.push(s);var h=null,o=0;null!=t&&(h=w(t=N(n,t,"key")),o=t.length,n.push(h));var p=new T(e|=0),y=p.address;if(n.push(y),!(0|a._crypto_generichash(y,e,s,c,0,h,o))){var i=x(p,_);return A(n),i}M(n,"invalid usage")}function wa(e,r,t,_,n){var s=[];S(n),K(s,e,"subkey_len"),("number"!=typeof e||(0|e)!==e||e<0)&&I(s,"subkey_len must be an unsigned integer");var c=null,h=0;null!=r&&(c=w(r=N(s,r,"key")),h=r.length,s.push(c));var o=null,p=0;null!=t&&(t=N(s,t,"id"),p=0|a._crypto_generichash_blake2b_saltbytes(),t.length!==p&&I(s,"invalid id length"),o=w(t),s.push(o));var y=null,i=0;null!=_&&(_=N(s,_,"ctx"),i=0|a._crypto_generichash_blake2b_personalbytes(),_.length!==i&&I(s,"invalid ctx length"),y=w(_),s.push(y));var l=new T(0|e),u=l.address;if(s.push(u),!(0|a._crypto_generichash_blake2b_salt_personal(u,e,null,0,0,c,h,o,y))){var d=x(l,n);return A(s),d}M(s,"invalid usage")}function Ya(e,r,t){var _=[];S(t),K(_,e,"state_address"),K(_,r,"hash_length"),("number"!=typeof r||(0|r)!==r||r<0)&&I(_,"hash_length must be an unsigned integer");var n=new T(r|=0),s=n.address;if(_.push(s),!(0|a._crypto_generichash_final(e,s,r))){var c=(a._free(e),x(n,t));return A(_),c}M(_,"invalid usage")}function Ba(e,r,t){var _=[];S(t);var n=null,s=0;null!=e&&(n=w(e=N(_,e,"key")),s=e.length,_.push(n)),K(_,r,"hash_length"),("number"!=typeof r||(0|r)!==r||r<0)&&I(_,"hash_length must be an unsigned integer");var c=new T(357).address;if(!(0|a._crypto_generichash_init(c,n,s,r))){var h=c;return A(_),h}M(_,"invalid usage")}function Aa(e){var r=[];S(e);var t=new T(0|a._crypto_generichash_keybytes()),_=t.address;r.push(_),a._crypto_generichash_keygen(_);var n=x(t,e);return A(r),n}function Ma(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_generichash_update(e,n,s)&&M(_,"invalid usage"),A(_)}function Ia(e,r){var t=[];S(r);var _=w(e=N(t,e,"message")),n=e.length;t.push(_);var s=new T(0|a._crypto_hash_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_hash(c,_,n,0))){var h=x(s,r);return A(t),h}M(t,"invalid usage")}function Ka(e,r){var t=[];S(r);var _=w(e=N(t,e,"message")),n=e.length;t.push(_);var s=new T(0|a._crypto_hash_sha256_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_hash_sha256(c,_,n,0))){var h=x(s,r);return A(t),h}M(t,"invalid usage")}function Na(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_hash_sha256_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_hash_sha256_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function La(e){var r=[];S(e);var t=new T(104).address;if(!(0|a._crypto_hash_sha256_init(t))){var _=t;return A(r),_}M(r,"invalid usage")}function Oa(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_hash_sha256_update(e,n,s)&&M(_,"invalid usage"),A(_)}function Ua(e,r){var t=[];S(r);var _=w(e=N(t,e,"message")),n=e.length;t.push(_);var s=new T(0|a._crypto_hash_sha512_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_hash_sha512(c,_,n,0))){var h=x(s,r);return A(t),h}M(t,"invalid usage")}function Ca(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_hash_sha512_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_hash_sha512_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function Pa(e){var r=[];S(e);var t=new T(208).address;if(!(0|a._crypto_hash_sha512_init(t))){var _=t;return A(r),_}M(r,"invalid usage")}function Ra(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_hash_sha512_update(e,n,s)&&M(_,"invalid usage"),A(_)}function Xa(e,r,t,_,n){var s=[];S(n),K(s,e,"subkey_len"),("number"!=typeof e||(0|e)!==e||e<0)&&I(s,"subkey_len must be an unsigned integer"),K(s,r,"subkey_id");var c,h=0;if("bigint"==typeof r&&r>=BigInt(0)){const e=r>>BigInt(32);e>BigInt(4294967295)&&I(s,"subkey_id cannot be more than 64 bits"),h=Number(e),c=Number(r&BigInt(4294967295))}else"number"==typeof r&&(0|r)===r&&r>=0?c=r:I(s,"subkey_id must be an unsigned integer or bigint");"string"!=typeof t&&I(s,"ctx must be a string"),(t=l(t+"\0")).length-1!==a._crypto_kdf_contextbytes()&&I(s,"invalid ctx length");var o=w(t);t.length,s.push(o),_=N(s,_,"key");var p,y=0|a._crypto_kdf_keybytes();_.length!==y&&I(s,"invalid key length"),p=w(_),s.push(p);var i=new T(0|e),u=i.address;s.push(u),a._crypto_kdf_derive_from_key(u,e,c,h,o,p);var d=x(i,n);return A(s),d}function Ga(e){var r=[];S(e);var t=new T(0|a._crypto_kdf_keybytes()),_=t.address;r.push(_),a._crypto_kdf_keygen(_);var n=x(t,e);return A(r),n}function Da(e,r,t,_){var n=[];S(_),e=N(n,e,"clientPublicKey");var s,c=0|a._crypto_kx_publickeybytes();e.length!==c&&I(n,"invalid clientPublicKey length"),s=w(e),n.push(s),r=N(n,r,"clientSecretKey");var h,o=0|a._crypto_kx_secretkeybytes();r.length!==o&&I(n,"invalid clientSecretKey length"),h=w(r),n.push(h),t=N(n,t,"serverPublicKey");var p,y=0|a._crypto_kx_publickeybytes();t.length!==y&&I(n,"invalid serverPublicKey length"),p=w(t),n.push(p);var i=new T(0|a._crypto_kx_sessionkeybytes()),l=i.address;n.push(l);var u=new T(0|a._crypto_kx_sessionkeybytes()),d=u.address;if(n.push(d),!(0|a._crypto_kx_client_session_keys(l,d,s,h,p))){var v=x({sharedRx:i,sharedTx:u},_);return A(n),v}M(n,"invalid usage")}function Fa(e){var r=[];S(e);var t=new T(0|a._crypto_kx_publickeybytes()),_=t.address;r.push(_);var n=new T(0|a._crypto_kx_secretkeybytes()),s=n.address;if(r.push(s),!(0|a._crypto_kx_keypair(_,s))){var c={publicKey:x(t,e),privateKey:x(n,e),keyType:"x25519"};return A(r),c}M(r,"internal error")}function Va(e,r){var t=[];S(r),e=N(t,e,"seed");var _,n=0|a._crypto_kx_seedbytes();e.length!==n&&I(t,"invalid seed length"),_=w(e),t.push(_);var s=new T(0|a._crypto_kx_publickeybytes()),c=s.address;t.push(c);var h=new T(0|a._crypto_kx_secretkeybytes()),o=h.address;if(t.push(o),!(0|a._crypto_kx_seed_keypair(c,o,_))){var p={publicKey:x(s,r),privateKey:x(h,r),keyType:"x25519"};return A(t),p}M(t,"internal error")}function Ha(e,r,t,_){var n=[];S(_),e=N(n,e,"serverPublicKey");var s,c=0|a._crypto_kx_publickeybytes();e.length!==c&&I(n,"invalid serverPublicKey length"),s=w(e),n.push(s),r=N(n,r,"serverSecretKey");var h,o=0|a._crypto_kx_secretkeybytes();r.length!==o&&I(n,"invalid serverSecretKey length"),h=w(r),n.push(h),t=N(n,t,"clientPublicKey");var p,y=0|a._crypto_kx_publickeybytes();t.length!==y&&I(n,"invalid clientPublicKey length"),p=w(t),n.push(p);var i=new T(0|a._crypto_kx_sessionkeybytes()),l=i.address;n.push(l);var u=new T(0|a._crypto_kx_sessionkeybytes()),d=u.address;if(n.push(d),!(0|a._crypto_kx_server_session_keys(l,d,s,h,p))){var v=x({sharedRx:i,sharedTx:u},_);return A(n),v}M(n,"invalid usage")}function Wa(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_onetimeauth_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_onetimeauth_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_onetimeauth(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function qa(e,r){var t=[];S(r),K(t,e,"state_address");var _=new T(0|a._crypto_onetimeauth_bytes()),n=_.address;if(t.push(n),!(0|a._crypto_onetimeauth_final(e,n))){var s=(a._free(e),x(_,r));return A(t),s}M(t,"invalid usage")}function za(e,r){var t=[];S(r);var _=null;null!=e&&(_=w(e=N(t,e,"key")),e.length,t.push(_));var n=new T(144).address;if(!(0|a._crypto_onetimeauth_init(n,_))){var s=n;return A(t),s}M(t,"invalid usage")}function ja(e){var r=[];S(e);var t=new T(0|a._crypto_onetimeauth_keybytes()),_=t.address;r.push(_),a._crypto_onetimeauth_keygen(_);var n=x(t,e);return A(r),n}function Ja(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_onetimeauth_update(e,n,s)&&M(_,"invalid usage"),A(_)}function Qa(e,r,t){var _=[];e=N(_,e,"hash");var n,s=0|a._crypto_onetimeauth_bytes();e.length!==s&&I(_,"invalid hash length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"key");var o,p=0|a._crypto_onetimeauth_keybytes();t.length!==p&&I(_,"invalid key length"),o=w(t),_.push(o);var y=!(0|a._crypto_onetimeauth_verify(n,c,h,0,o));return A(_),y}function Za(e,r,t,_,n,s,c){var h=[];S(c),K(h,e,"keyLength"),("number"!=typeof e||(0|e)!==e||e<0)&&I(h,"keyLength must be an unsigned integer");var o=w(r=N(h,r,"password")),p=r.length;h.push(o),t=N(h,t,"salt");var y,i=0|a._crypto_pwhash_saltbytes();t.length!==i&&I(h,"invalid salt length"),y=w(t),h.push(y),K(h,_,"opsLimit"),("number"!=typeof _||(0|_)!==_||_<0)&&I(h,"opsLimit must be an unsigned integer"),K(h,n,"memLimit"),("number"!=typeof n||(0|n)!==n||n<0)&&I(h,"memLimit must be an unsigned integer"),K(h,s,"algorithm"),("number"!=typeof s||(0|s)!==s||s<0)&&I(h,"algorithm must be an unsigned integer");var l=new T(0|e),u=l.address;if(h.push(u),!(0|a._crypto_pwhash(u,e,0,o,p,0,y,_,0,n,s))){var d=x(l,c);return A(h),d}M(h,"invalid usage")}function $a(e,r,t,_,n,s){var c=[];S(s),K(c,e,"keyLength"),("number"!=typeof e||(0|e)!==e||e<0)&&I(c,"keyLength must be an unsigned integer");var h=w(r=N(c,r,"password")),o=r.length;c.push(h),t=N(c,t,"salt");var p,y=0|a._crypto_pwhash_scryptsalsa208sha256_saltbytes();t.length!==y&&I(c,"invalid salt length"),p=w(t),c.push(p),K(c,_,"opsLimit"),("number"!=typeof _||(0|_)!==_||_<0)&&I(c,"opsLimit must be an unsigned integer"),K(c,n,"memLimit"),("number"!=typeof n||(0|n)!==n||n<0)&&I(c,"memLimit must be an unsigned integer");var i=new T(0|e),l=i.address;if(c.push(l),!(0|a._crypto_pwhash_scryptsalsa208sha256(l,e,0,h,o,0,p,_,0,n))){var u=x(i,s);return A(c),u}M(c,"invalid usage")}function er(e,r,t,_,n,s,c){var h=[];S(c);var o=w(e=N(h,e,"password")),p=e.length;h.push(o);var y=w(r=N(h,r,"salt")),i=r.length;h.push(y),K(h,t,"opsLimit"),("number"!=typeof t||(0|t)!==t||t<0)&&I(h,"opsLimit must be an unsigned integer"),K(h,_,"r"),("number"!=typeof _||(0|_)!==_||_<0)&&I(h,"r must be an unsigned integer"),K(h,n,"p"),("number"!=typeof n||(0|n)!==n||n<0)&&I(h,"p must be an unsigned integer"),K(h,s,"keyLength"),("number"!=typeof s||(0|s)!==s||s<0)&&I(h,"keyLength must be an unsigned integer");var l=new T(0|s),u=l.address;if(h.push(u),!(0|a._crypto_pwhash_scryptsalsa208sha256_ll(o,p,y,i,t,0,_,n,u,s))){var d=x(l,c);return A(h),d}M(h,"invalid usage")}function ar(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"password")),c=e.length;n.push(s),K(n,r,"opsLimit"),("number"!=typeof r||(0|r)!==r||r<0)&&I(n,"opsLimit must be an unsigned integer"),K(n,t,"memLimit"),("number"!=typeof t||(0|t)!==t||t<0)&&I(n,"memLimit must be an unsigned integer");var h=new T(0|a._crypto_pwhash_scryptsalsa208sha256_strbytes()).address;if(n.push(h),!(0|a._crypto_pwhash_scryptsalsa208sha256_str(h,s,c,0,r,0,t))){var o=a.UTF8ToString(h);return A(n),o}M(n,"invalid usage")}function rr(e,r,t){var _=[];S(t),"string"!=typeof e&&I(_,"hashed_password must be a string");var n=w(e=l(e+"\0"));e.length,_.push(n);var s=w(r=N(_,r,"password")),c=r.length;_.push(s);var h=!(0|a._crypto_pwhash_scryptsalsa208sha256_str_verify(n,s,c,0));return A(_),h}function tr(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"password")),c=e.length;n.push(s),K(n,r,"opsLimit"),("number"!=typeof r||(0|r)!==r||r<0)&&I(n,"opsLimit must be an unsigned integer"),K(n,t,"memLimit"),("number"!=typeof t||(0|t)!==t||t<0)&&I(n,"memLimit must be an unsigned integer");var h=new T(0|a._crypto_pwhash_strbytes()).address;if(n.push(h),!(0|a._crypto_pwhash_str(h,s,c,0,r,0,t))){var o=a.UTF8ToString(h);return A(n),o}M(n,"invalid usage")}function _r(e,r,t,_){var n=[];S(_),"string"!=typeof e&&I(n,"hashed_password must be a string");var s=w(e=l(e+"\0"));e.length,n.push(s),K(n,r,"opsLimit"),("number"!=typeof r||(0|r)!==r||r<0)&&I(n,"opsLimit must be an unsigned integer"),K(n,t,"memLimit"),("number"!=typeof t||(0|t)!==t||t<0)&&I(n,"memLimit must be an unsigned integer");var c=!!(0|a._crypto_pwhash_str_needs_rehash(s,r,0,t));return A(n),c}function nr(e,r,t){var _=[];S(t),"string"!=typeof e&&I(_,"hashed_password must be a string");var n=w(e=l(e+"\0"));e.length,_.push(n);var s=w(r=N(_,r,"password")),c=r.length;_.push(s);var h=!(0|a._crypto_pwhash_str_verify(n,s,c,0));return A(_),h}function sr(e,r,t){var _=[];S(t),e=N(_,e,"privateKey");var n,s=0|a._crypto_scalarmult_scalarbytes();e.length!==s&&I(_,"invalid privateKey length"),n=w(e),_.push(n),r=N(_,r,"publicKey");var c,h=0|a._crypto_scalarmult_bytes();r.length!==h&&I(_,"invalid publicKey length"),c=w(r),_.push(c);var o=new T(0|a._crypto_scalarmult_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_scalarmult(p,n,c))){var y=x(o,t);return A(_),y}M(_,"weak public key")}function cr(e,r){var t=[];S(r),e=N(t,e,"privateKey");var _,n=0|a._crypto_scalarmult_scalarbytes();e.length!==n&&I(t,"invalid privateKey length"),_=w(e),t.push(_);var s=new T(0|a._crypto_scalarmult_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_scalarmult_base(c,_))){var h=x(s,r);return A(t),h}M(t,"unknown error")}function hr(e,r,t){var _=[];S(t),e=N(_,e,"n");var n,s=0|a._crypto_scalarmult_ed25519_scalarbytes();e.length!==s&&I(_,"invalid n length"),n=w(e),_.push(n),r=N(_,r,"p");var c,h=0|a._crypto_scalarmult_ed25519_bytes();r.length!==h&&I(_,"invalid p length"),c=w(r),_.push(c);var o=new T(0|a._crypto_scalarmult_ed25519_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_scalarmult_ed25519(p,n,c))){var y=x(o,t);return A(_),y}M(_,"invalid point or scalar is 0")}function or(e,r){var t=[];S(r),e=N(t,e,"scalar");var _,n=0|a._crypto_scalarmult_ed25519_scalarbytes();e.length!==n&&I(t,"invalid scalar length"),_=w(e),t.push(_);var s=new T(0|a._crypto_scalarmult_ed25519_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_scalarmult_ed25519_base(c,_))){var h=x(s,r);return A(t),h}M(t,"scalar is 0")}function pr(e,r){var t=[];S(r),e=N(t,e,"scalar");var _,n=0|a._crypto_scalarmult_ed25519_scalarbytes();e.length!==n&&I(t,"invalid scalar length"),_=w(e),t.push(_);var s=new T(0|a._crypto_scalarmult_ed25519_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_scalarmult_ed25519_base_noclamp(c,_))){var h=x(s,r);return A(t),h}M(t,"scalar is 0")}function yr(e,r,t){var _=[];S(t),e=N(_,e,"n");var n,s=0|a._crypto_scalarmult_ed25519_scalarbytes();e.length!==s&&I(_,"invalid n length"),n=w(e),_.push(n),r=N(_,r,"p");var c,h=0|a._crypto_scalarmult_ed25519_bytes();r.length!==h&&I(_,"invalid p length"),c=w(r),_.push(c);var o=new T(0|a._crypto_scalarmult_ed25519_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_scalarmult_ed25519_noclamp(p,n,c))){var y=x(o,t);return A(_),y}M(_,"invalid point or scalar is 0")}function ir(e,r,t){var _=[];S(t),e=N(_,e,"scalar");var n,s=0|a._crypto_scalarmult_ristretto255_scalarbytes();e.length!==s&&I(_,"invalid scalar length"),n=w(e),_.push(n),r=N(_,r,"element");var c,h=0|a._crypto_scalarmult_ristretto255_bytes();r.length!==h&&I(_,"invalid element length"),c=w(r),_.push(c);var o=new T(0|a._crypto_scalarmult_ristretto255_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_scalarmult_ristretto255(p,n,c))){var y=x(o,t);return A(_),y}M(_,"result is identity element")}function lr(e,r){var t=[];S(r),e=N(t,e,"scalar");var _,n=0|a._crypto_core_ristretto255_scalarbytes();e.length!==n&&I(t,"invalid scalar length"),_=w(e),t.push(_);var s=new T(0|a._crypto_core_ristretto255_bytes()),c=s.address;if(t.push(c),!(0|a._crypto_scalarmult_ristretto255_base(c,_))){var h=x(s,r);return A(t),h}M(t,"scalar is 0")}function ur(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_secretbox_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"key");var p,y=0|a._crypto_secretbox_keybytes();t.length!==y&&I(n,"invalid key length"),p=w(t),n.push(p);var i=new T(0|c),l=i.address;n.push(l);var u=new T(0|a._crypto_secretbox_macbytes()),d=u.address;if(n.push(d),!(0|a._crypto_secretbox_detached(l,d,s,c,0,h,p))){var v=x({mac:u,cipher:i},_);return A(n),v}M(n,"invalid usage")}function dr(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_secretbox_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"key");var p,y=0|a._crypto_secretbox_keybytes();t.length!==y&&I(n,"invalid key length"),p=w(t),n.push(p);var i=new T(c+a._crypto_secretbox_macbytes()|0),l=i.address;if(n.push(l),!(0|a._crypto_secretbox_easy(l,s,c,0,h,p))){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function vr(e){var r=[];S(e);var t=new T(0|a._crypto_secretbox_keybytes()),_=t.address;r.push(_),a._crypto_secretbox_keygen(_);var n=x(t,e);return A(r),n}function gr(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"ciphertext")),h=e.length;s.push(c),r=N(s,r,"mac");var o,p=0|a._crypto_secretbox_macbytes();r.length!==p&&I(s,"invalid mac length"),o=w(r),s.push(o),t=N(s,t,"nonce");var y,i=0|a._crypto_secretbox_noncebytes();t.length!==i&&I(s,"invalid nonce length"),y=w(t),s.push(y),_=N(s,_,"key");var l,u=0|a._crypto_secretbox_keybytes();_.length!==u&&I(s,"invalid key length"),l=w(_),s.push(l);var d=new T(0|h),v=d.address;if(s.push(v),!(0|a._crypto_secretbox_open_detached(v,c,o,h,0,y,l))){var g=x(d,n);return A(s),g}M(s,"wrong secret key for the given ciphertext")}function br(e,r,t,_){var n=[];S(_),e=N(n,e,"ciphertext");var s,c=a._crypto_secretbox_macbytes(),h=e.length;h<c&&I(n,"ciphertext is too short"),s=w(e),n.push(s),r=N(n,r,"nonce");var o,p=0|a._crypto_secretbox_noncebytes();r.length!==p&&I(n,"invalid nonce length"),o=w(r),n.push(o),t=N(n,t,"key");var y,i=0|a._crypto_secretbox_keybytes();t.length!==i&&I(n,"invalid key length"),y=w(t),n.push(y);var l=new T(h-a._crypto_secretbox_macbytes()|0),u=l.address;if(n.push(u),!(0|a._crypto_secretbox_open_easy(u,s,h,0,o,y))){var d=x(l,_);return A(n),d}M(n,"wrong secret key for the given ciphertext")}function fr(e,r,t){var _=[];S(t),e=N(_,e,"header");var n,s=0|a._crypto_secretstream_xchacha20poly1305_headerbytes();e.length!==s&&I(_,"invalid header length"),n=w(e),_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_secretstream_xchacha20poly1305_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(52).address;if(!(0|a._crypto_secretstream_xchacha20poly1305_init_pull(o,n,c))){var p=o;return A(_),p}M(_,"invalid usage")}function mr(e,r){var t=[];S(r),e=N(t,e,"key");var _,n=0|a._crypto_secretstream_xchacha20poly1305_keybytes();e.length!==n&&I(t,"invalid key length"),_=w(e),t.push(_);var s=new T(52).address,c=new T(0|a._crypto_secretstream_xchacha20poly1305_headerbytes()),h=c.address;if(t.push(h),!(0|a._crypto_secretstream_xchacha20poly1305_init_push(s,h,_))){var o={state:s,header:x(c,r)};return A(t),o}M(t,"invalid usage")}function Er(e){var r=[];S(e);var t=new T(0|a._crypto_secretstream_xchacha20poly1305_keybytes()),_=t.address;r.push(_),a._crypto_secretstream_xchacha20poly1305_keygen(_);var n=x(t,e);return A(r),n}function xr(e,r,t,_){var n=[];S(_),K(n,e,"state_address"),r=N(n,r,"cipher");var s,c=a._crypto_secretstream_xchacha20poly1305_abytes(),h=r.length;h<c&&I(n,"cipher is too short"),s=w(r),n.push(s);var o=null,p=0;null!=t&&(o=w(t=N(n,t,"ad")),p=t.length,n.push(o));var y=new T(h-a._crypto_secretstream_xchacha20poly1305_abytes()|0),i=y.address;n.push(i);var l,u=(l=Y(1),n.push(l),(u=0===a._crypto_secretstream_xchacha20poly1305_pull(e,i,0,l,s,h,0,o,p)&&{tag:a.HEAPU8[l],message:y})&&{message:x(u.message,_),tag:u.tag});return A(n),u}function kr(e,r,t,_,n){var s=[];S(n),K(s,e,"state_address");var c=w(r=N(s,r,"message_chunk")),h=r.length;s.push(c);var o=null,p=0;null!=t&&(o=w(t=N(s,t,"ad")),p=t.length,s.push(o)),K(s,_,"tag"),("number"!=typeof _||(0|_)!==_||_<0)&&I(s,"tag must be an unsigned integer");var y=new T(h+a._crypto_secretstream_xchacha20poly1305_abytes()|0),i=y.address;if(s.push(i),!(0|a._crypto_secretstream_xchacha20poly1305_push(e,i,0,c,h,0,o,p,0,_))){var l=x(y,n);return A(s),l}M(s,"invalid usage")}function Sr(e,r){var t=[];return S(r),K(t,e,"state_address"),a._crypto_secretstream_xchacha20poly1305_rekey(e),A(t),!0}function Tr(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_shorthash_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_shorthash_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_shorthash(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function wr(e){var r=[];S(e);var t=new T(0|a._crypto_shorthash_keybytes()),_=t.address;r.push(_),a._crypto_shorthash_keygen(_);var n=x(t,e);return A(r),n}function Yr(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"key");var c,h=0|a._crypto_shorthash_siphashx24_keybytes();r.length!==h&&I(_,"invalid key length"),c=w(r),_.push(c);var o=new T(0|a._crypto_shorthash_siphashx24_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_shorthash_siphashx24(p,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function Br(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"privateKey");var c,h=0|a._crypto_sign_secretkeybytes();r.length!==h&&I(_,"invalid privateKey length"),c=w(r),_.push(c);var o=new T(e.length+a._crypto_sign_bytes()|0),p=o.address;if(_.push(p),!(0|a._crypto_sign(p,null,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function Ar(e,r,t){var _=[];S(t);var n=w(e=N(_,e,"message")),s=e.length;_.push(n),r=N(_,r,"privateKey");var c,h=0|a._crypto_sign_secretkeybytes();r.length!==h&&I(_,"invalid privateKey length"),c=w(r),_.push(c);var o=new T(0|a._crypto_sign_bytes()),p=o.address;if(_.push(p),!(0|a._crypto_sign_detached(p,null,n,s,0,c))){var y=x(o,t);return A(_),y}M(_,"invalid usage")}function Mr(e,r){var t=[];S(r),e=N(t,e,"edPk");var _,n=0|a._crypto_sign_publickeybytes();e.length!==n&&I(t,"invalid edPk length"),_=w(e),t.push(_);var s=new T(0|a._crypto_scalarmult_scalarbytes()),c=s.address;if(t.push(c),!(0|a._crypto_sign_ed25519_pk_to_curve25519(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid key")}function Ir(e,r){var t=[];S(r),e=N(t,e,"edSk");var _,n=0|a._crypto_sign_secretkeybytes();e.length!==n&&I(t,"invalid edSk length"),_=w(e),t.push(_);var s=new T(0|a._crypto_scalarmult_scalarbytes()),c=s.address;if(t.push(c),!(0|a._crypto_sign_ed25519_sk_to_curve25519(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid key")}function Kr(e,r){var t=[];S(r),e=N(t,e,"privateKey");var _,n=0|a._crypto_sign_secretkeybytes();e.length!==n&&I(t,"invalid privateKey length"),_=w(e),t.push(_);var s=new T(0|a._crypto_sign_publickeybytes()),c=s.address;if(t.push(c),!(0|a._crypto_sign_ed25519_sk_to_pk(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid key")}function Nr(e,r){var t=[];S(r),e=N(t,e,"privateKey");var _,n=0|a._crypto_sign_secretkeybytes();e.length!==n&&I(t,"invalid privateKey length"),_=w(e),t.push(_);var s=new T(0|a._crypto_sign_seedbytes()),c=s.address;if(t.push(c),!(0|a._crypto_sign_ed25519_sk_to_seed(c,_))){var h=x(s,r);return A(t),h}M(t,"invalid key")}function Lr(e,r,t){var _=[];S(t),K(_,e,"state_address"),r=N(_,r,"privateKey");var n,s=0|a._crypto_sign_secretkeybytes();r.length!==s&&I(_,"invalid privateKey length"),n=w(r),_.push(n);var c=new T(0|a._crypto_sign_bytes()),h=c.address;if(_.push(h),!(0|a._crypto_sign_final_create(e,h,null,n))){var o=(a._free(e),x(c,t));return A(_),o}M(_,"invalid usage")}function Or(e,r,t,_){var n=[];S(_),K(n,e,"state_address"),r=N(n,r,"signature");var s,c=0|a._crypto_sign_bytes();r.length!==c&&I(n,"invalid signature length"),s=w(r),n.push(s),t=N(n,t,"publicKey");var h,o=0|a._crypto_sign_publickeybytes();t.length!==o&&I(n,"invalid publicKey length"),h=w(t),n.push(h);var p=!(0|a._crypto_sign_final_verify(e,s,h));return A(n),p}function Ur(e){var r=[];S(e);var t=new T(208).address;if(!(0|a._crypto_sign_init(t))){var _=t;return A(r),_}M(r,"internal error")}function Cr(e){var r=[];S(e);var t=new T(0|a._crypto_sign_publickeybytes()),_=t.address;r.push(_);var n=new T(0|a._crypto_sign_secretkeybytes()),s=n.address;if(r.push(s),!(0|a._crypto_sign_keypair(_,s))){var c={publicKey:x(t,e),privateKey:x(n,e),keyType:"ed25519"};return A(r),c}M(r,"internal error")}function Pr(e,r,t){var _=[];S(t),e=N(_,e,"signedMessage");var n,s=a._crypto_sign_bytes(),c=e.length;c<s&&I(_,"signedMessage is too short"),n=w(e),_.push(n),r=N(_,r,"publicKey");var h,o=0|a._crypto_sign_publickeybytes();r.length!==o&&I(_,"invalid publicKey length"),h=w(r),_.push(h);var p=new T(c-a._crypto_sign_bytes()|0),y=p.address;if(_.push(y),!(0|a._crypto_sign_open(y,null,n,c,0,h))){var i=x(p,t);return A(_),i}M(_,"incorrect signature for the given public key")}function Rr(e,r){var t=[];S(r),e=N(t,e,"seed");var _,n=0|a._crypto_sign_seedbytes();e.length!==n&&I(t,"invalid seed length"),_=w(e),t.push(_);var s=new T(0|a._crypto_sign_publickeybytes()),c=s.address;t.push(c);var h=new T(0|a._crypto_sign_secretkeybytes()),o=h.address;if(t.push(o),!(0|a._crypto_sign_seed_keypair(c,o,_))){var p={publicKey:x(s,r),privateKey:x(h,r),keyType:"ed25519"};return A(t),p}M(t,"invalid usage")}function Xr(e,r,t){var _=[];S(t),K(_,e,"state_address");var n=w(r=N(_,r,"message_chunk")),s=r.length;_.push(n),0|a._crypto_sign_update(e,n,s,0)&&M(_,"invalid usage"),A(_)}function Gr(e,r,t){var _=[];e=N(_,e,"signature");var n,s=0|a._crypto_sign_bytes();e.length!==s&&I(_,"invalid signature length"),n=w(e),_.push(n);var c=w(r=N(_,r,"message")),h=r.length;_.push(c),t=N(_,t,"publicKey");var o,p=0|a._crypto_sign_publickeybytes();t.length!==p&&I(_,"invalid publicKey length"),o=w(t),_.push(o);var y=!(0|a._crypto_sign_verify_detached(n,c,h,0,o));return A(_),y}function Dr(e,r,t,_){var n=[];S(_),K(n,e,"outLength"),("number"!=typeof e||(0|e)!==e||e<0)&&I(n,"outLength must be an unsigned integer"),r=N(n,r,"key");var s,c=0|a._crypto_stream_chacha20_keybytes();r.length!==c&&I(n,"invalid key length"),s=w(r),n.push(s),t=N(n,t,"nonce");var h,o=0|a._crypto_stream_chacha20_noncebytes();t.length!==o&&I(n,"invalid nonce length"),h=w(t),n.push(h);var p=new T(0|e),y=p.address;n.push(y),a._crypto_stream_chacha20(y,e,0,h,s);var i=x(p,_);return A(n),i}function Fr(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"input_message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_stream_chacha20_ietf_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"key");var p,y=0|a._crypto_stream_chacha20_ietf_keybytes();t.length!==y&&I(n,"invalid key length"),p=w(t),n.push(p);var i=new T(0|c),l=i.address;if(n.push(l),0===a._crypto_stream_chacha20_ietf_xor(l,s,c,0,h,p)){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function Vr(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"input_message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_stream_chacha20_ietf_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),K(s,t,"nonce_increment"),("number"!=typeof t||(0|t)!==t||t<0)&&I(s,"nonce_increment must be an unsigned integer"),_=N(s,_,"key");var y,i=0|a._crypto_stream_chacha20_ietf_keybytes();_.length!==i&&I(s,"invalid key length"),y=w(_),s.push(y);var l=new T(0|h),u=l.address;if(s.push(u),0===a._crypto_stream_chacha20_ietf_xor_ic(u,c,h,0,o,t,y)){var d=x(l,n);return A(s),d}M(s,"invalid usage")}function Hr(e){var r=[];S(e);var t=new T(0|a._crypto_stream_chacha20_keybytes()),_=t.address;r.push(_),a._crypto_stream_chacha20_keygen(_);var n=x(t,e);return A(r),n}function Wr(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"input_message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_stream_chacha20_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"key");var p,y=0|a._crypto_stream_chacha20_keybytes();t.length!==y&&I(n,"invalid key length"),p=w(t),n.push(p);var i=new T(0|c),l=i.address;if(n.push(l),0===a._crypto_stream_chacha20_xor(l,s,c,0,h,p)){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function qr(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"input_message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_stream_chacha20_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),K(s,t,"nonce_increment"),("number"!=typeof t||(0|t)!==t||t<0)&&I(s,"nonce_increment must be an unsigned integer"),_=N(s,_,"key");var y,i=0|a._crypto_stream_chacha20_keybytes();_.length!==i&&I(s,"invalid key length"),y=w(_),s.push(y);var l=new T(0|h),u=l.address;if(s.push(u),0===a._crypto_stream_chacha20_xor_ic(u,c,h,0,o,t,0,y)){var d=x(l,n);return A(s),d}M(s,"invalid usage")}function zr(e){var r=[];S(e);var t=new T(0|a._crypto_stream_keybytes()),_=t.address;r.push(_),a._crypto_stream_keygen(_);var n=x(t,e);return A(r),n}function jr(e){var r=[];S(e);var t=new T(0|a._crypto_stream_xchacha20_keybytes()),_=t.address;r.push(_),a._crypto_stream_xchacha20_keygen(_);var n=x(t,e);return A(r),n}function Jr(e,r,t,_){var n=[];S(_);var s=w(e=N(n,e,"input_message")),c=e.length;n.push(s),r=N(n,r,"nonce");var h,o=0|a._crypto_stream_xchacha20_noncebytes();r.length!==o&&I(n,"invalid nonce length"),h=w(r),n.push(h),t=N(n,t,"key");var p,y=0|a._crypto_stream_xchacha20_keybytes();t.length!==y&&I(n,"invalid key length"),p=w(t),n.push(p);var i=new T(0|c),l=i.address;if(n.push(l),0===a._crypto_stream_xchacha20_xor(l,s,c,0,h,p)){var u=x(i,_);return A(n),u}M(n,"invalid usage")}function Qr(e,r,t,_,n){var s=[];S(n);var c=w(e=N(s,e,"input_message")),h=e.length;s.push(c),r=N(s,r,"nonce");var o,p=0|a._crypto_stream_xchacha20_noncebytes();r.length!==p&&I(s,"invalid nonce length"),o=w(r),s.push(o),K(s,t,"nonce_increment"),("number"!=typeof t||(0|t)!==t||t<0)&&I(s,"nonce_increment must be an unsigned integer"),_=N(s,_,"key");var y,i=0|a._crypto_stream_xchacha20_keybytes();_.length!==i&&I(s,"invalid key length"),y=w(_),s.push(y);var l=new T(0|h),u=l.address;if(s.push(u),0===a._crypto_stream_xchacha20_xor_ic(u,c,h,0,o,t,0,y)){var d=x(l,n);return A(s),d}M(s,"invalid usage")}function Zr(e,r){var t=[];S(r),K(t,e,"length"),("number"!=typeof e||(0|e)!==e||e<0)&&I(t,"length must be an unsigned integer");var _=new T(0|e),n=_.address;t.push(n),a._randombytes_buf(n,e);var s=x(_,r);return A(t),s}function $r(e,r,t){var _=[];S(t),K(_,e,"length"),("number"!=typeof e||(0|e)!==e||e<0)&&I(_,"length must be an unsigned integer"),r=N(_,r,"seed");var n,s=0|a._randombytes_seedbytes();r.length!==s&&I(_,"invalid seed length"),n=w(r),_.push(n);var c=new T(0|e),h=c.address;_.push(h),a._randombytes_buf_deterministic(h,e,n);var o=x(c,t);return A(_),o}function et(e){S(e),a._randombytes_close()}function at(e){S(e);var r=a._randombytes_random()>>>0;return A([]),r}function rt(e,r){var t=[];S(r);for(var _=a._malloc(24),n=0;n<6;n++)a.setValue(_+4*n,a.Runtime.addFunction(e[["implementation_name","random","stir","uniform","buf","close"][n]]),"i32");0|a._randombytes_set_implementation(_)&&M(t,"unsupported implementation"),A(t)}function tt(e){S(e),a._randombytes_stir()}function _t(e,r){var t=[];S(r),K(t,e,"upper_bound"),("number"!=typeof e||(0|e)!==e||e<0)&&I(t,"upper_bound must be an unsigned integer");var _=a._randombytes_uniform(e)>>>0;return A(t),_}function nt(){var e=a._sodium_version_string(),r=a.UTF8ToString(e);return A([]),r}T.prototype.to_Uint8Array=function(){var e=new Uint8Array(this.length);return e.set(a.HEAPU8.subarray(this.address,this.address+this.length)),e},r.add=s,r.base64_variants=g,r.compare=p,r.from_base64=f,r.from_hex=d,r.from_string=l,r.increment=n,r.is_zero=c,r.libsodium=e,r.memcmp=o,r.memzero=h,r.output_formats=E,r.pad=y,r.unpad=i,r.ready=t,r.symbols=_,r.to_base64=m,r.to_hex=v,r.to_string=u;export default r;export{t as ready,s as add,p as compare,f as from_base64,d as from_hex,l as from_string,n as increment,c as is_zero,o as memcmp,h as memzero,y as pad,i as unpad,_ as symbols,m as to_base64,v as to_hex,u as to_string,E as output_formats,g as base64_variants,e as libsodium};
